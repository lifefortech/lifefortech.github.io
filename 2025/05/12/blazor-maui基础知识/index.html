<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>blazor maui基础知识 | Welcome To LifeTech's Blog</title><meta name="keywords" content="csharp相关学习"><meta name="author" content="Jackey Zhou"><meta name="copyright" content="Jackey Zhou"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="blazor maui基础知识"><meta name="application-name" content="blazor maui基础知识"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="blazor maui基础知识"><meta property="og:url" content="http://example.com/2025/05/12/blazor-maui%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/index.html"><meta property="og:site_name" content="Welcome To LifeTech's Blog"><meta property="og:description" content="目录  简介 什么是 .NET MAUI? 什么是 Blazor Hybrid? .NET MAUI Blazor Hybrid 的核心思想   为何选择 .NET MAUI Blazor Hybrid? (优势) 搭建开发环境 创建第一个 .NET MAUI Blazor 应用 使用 Visual"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta property="article:author" content="Jackey Zhou"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta name="description" content="目录  简介 什么是 .NET MAUI? 什么是 Blazor Hybrid? .NET MAUI Blazor Hybrid 的核心思想   为何选择 .NET MAUI Blazor Hybrid? (优势) 搭建开发环境 创建第一个 .NET MAUI Blazor 应用 使用 Visual"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/05/12/blazor-maui%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Jackey Zhou","link":"链接: ","source":"来源: Welcome To LifeTech's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Welcome To LifeTech's Blog',
  title: 'blazor maui基础知识',
  postAI: '',
  pageFillDescription: '1. 简介, 什么是 .NET MAUI?, 什么是 Blazor Hybrid?, .NET MAUI Blazor Hybrid 的核心思想, 2. 为何选择 .NET MAUI Blazor Hybrid? (优势), 3. 搭建开发环境, 4. 创建第一个 .NET MAUI Blazor 应用, 使用 Visual Studio, 使用 .NET CLI, 项目结构解析, 5. 核心组件 BlazorWebView, HostPage 属性, RootComponents 集合, 服务配置 (MauiProgram.cs), 6. 使用 Blazor 构建用户界面, Razor 组件 (.razor), 布局 (Layouts), 路由 (Routing), 数据绑定与事件处理, 依赖注入 (DI), 7. 访问本机设备功能 (Native Device Features), 通用方法：抽象与服务注入, .NET MAUI Essentials, 示例 1 获取设备信息, 示例 2 地理位置, 示例 3 调用平台特定 API (部分类与条件编译), 8. JavaScript 互操作 (JS Interop), 从 .NET 调用 JavaScript, 从 JavaScript 调用 .NET, 9. 样式化应用, 全局样式 (wwwroot/css), 组件作用域 CSS (.razor.css), 混合原生 UI 元素 (高级), 10. 代码共享策略, 与 Blazor Web 应用共享 Razor 类库 (RCL), 共享业务逻辑, 11. 调试 .NET MAUI Blazor 应用, 12. 部署, 13. .NET MAUI Blazor Hybrid 适用场景, 14. 局限性与考量, 15. 总结目录简介什么是什么是的核心思想为何选择优势搭建开发环境创建第一个应用使用使用项目结构解析核心组件属性集合服务配置使用构建用户界面组件布局路由数据绑定与事件处理依赖注入访问本机设备功能通用方法抽象与服务注入示例获取设备信息示例地理位置示例调用平台特定部分类与条件编译从组件调用原生功能互操作从调用从调用样式化应用全局样式组件作用域混合原生元素高级代码共享策略与应用共享类库共享业务逻辑调试应用部署适用场景局限性与考量总结简介什么是是一个跨平台的框架用于使用和或仅创建原生的移动和桌面应用程序它从演变而来允许开发者从单个共享代码库为和构建应用程序什么是是一种将一个用于使用构建交互式客户端的框架与原生客户端应用程序框架如结合起来的方法它允许开发者在原生应用中嵌入和渲染组件的核心思想的核心思想是让开发者能够重用组件来构建功能齐全的原生桌面和移动应用程序这些组件不是在浏览器沙箱中运行而是直接在进程中本地运行并使用嵌入式控件如上的上的上的上的来渲染关键在于尽管是通过技术渲染的但代码可以直接完全地访问本机设备功能和资源为何选择优势代码重用在桌面和移动应用之间共享组件样式和业务逻辑利用现有的开发技能和生态系统原生功能访问通过的和平台可以直接从代码中访问完整的原生设备功能如摄像头文件系统传感器等无需复杂的桥接层来访问大多数原生功能技术的灵活性利用和通过来构建美观响应式的用户界面可以使用现有的框架和设计知识单一代码库使用和为所有目标平台维护一个主要的代码库性能组件在进程中本地运行避免了像那样的运行时下载或像那样的网络延迟渲染在高效的现代控件中进行现代开发体验享受和或提供的强大工具库和社区支持逐步迁移集成可以将现有的应用的部分或全部迁移到原生移动桌面应用搭建开发环境要开始开发你需要安装最新版本的推荐或更新版本或更高版本确保安装了工作负载对于和开发需要一台构建主机并安装对于开发需要和模拟器设备可选安装和扩展命令行工具对于用户更为重要检查安装是否完整创建第一个应用使用打开选择创建新项目搜索并选择模板配置项目名称和位置然后点击创建使用项目结构解析一个典型的项目包含以下关键部分应用程序的入口点在这里配置服务字体处理程序以及注册定义应用程序范围的资源和行为通常用于设置主窗口默认的主页面通常包含控件来托管内容文件夹包含布局组件如包含页面组件如定义路由和默认布局在旧版本中这部分逻辑可能在如果项目是从旧模板升级的或直接由指向单个页面布局组件包含静态资源应用的宿主页面包含全局文件如文件图像等包含特定平台的代码和资源包含应用共享资源如图像字体应用图标启动画面全局的指令文件项目配置文件指定目标框架依赖项等核心组件是中的一个控件用于在其内部承载内容属性指定作为应用宿主的静态文件的路径通常是是的核心脚本用于初始化和管理应用与原生宿主之间的通信通常与在中配置启动结合使用集合指定要加载到中的根组件一个选择器指定中根组件应渲染到的元素通常是要渲染的根组件的类型例如或可选一个字典用于将初始参数传递给根组件服务配置是配置功能的关键位置注册服务添加开发工具注册和应用服务注册任何你需要的其他服务比如原生功能访问服务注册了正常运行所需的核心服务启用了在浏览器中进行调试的功能通常通过右键单击并选择检查或类似选项使用构建用户界面在应用中构建的方式与标准应用几乎完全相同组件由可重用的组件构成这些组件结合了标记和逻辑布局使用布局组件来定义通用的结构如导航菜单页眉页脚路由路由指令用于在应用内导航根路由组件如或旧模板中的会配置路由数据绑定与事件处理的数据绑定和事件处理等机制在应用中同样适用依赖注入的依赖注入系统允许你将服务包括访问原生功能的服务注入到你的组件中访问本机设备功能这是的核心优势之一你的代码可以直接调用原生通用方法抽象与服务注入最佳实践是创建一个抽象接口然后提供特定平台的实现或使用提供的跨平台实现然后将此服务注入到组件中包含一组名为的这些提供了对常见原生功能的跨平台访问例如示例获取设备信息无需额外服务可以直接使用在组件中使用示例地理位置创建服务接口可选但推荐用于解耦和测试创建服务实现检查并请求权限用户未授予权限处理设备不支持地理位置的情况处理权限问题处理其他异常在中注册服务在组件中注入并使用服务注意权限地理位置等功能需要在特定平台的清单文件中声明权限如的权限类可以帮助检查和请求运行时权限示例调用平台特定部分类与条件编译有时未涵盖你需要的功能或者你需要更深层次的平台特定控制定义接口共享代码创建部分类实现共享代码提供平台特定实现文件夹为创建类似的平台特定部分类或者使用条件编译在单个文件中注册服务从组件调用原生功能与之前示例类似注入并使用其方法和事件互操作尽管强调直接访问原生功能但有时仍需要与内的交互例如使用现有的库或执行某些的工作方式与或非常相似从调用注入服务在或引用的文件中定义从调用方法必须是静态的或实例方法通过并用标记样式化应用全局样式在或你选择的其他文件中定义全局样式这些样式会像在标准应用中一样应用于组件你也可以链接等框架组件作用域的隔离功能在应用中同样有效为组件创建文件其中的样式将仅应用于该组件构建过程会将这些作用域样式捆绑到中并在中引用混合原生元素高级虽然的主要在中但你仍然可以在之外使用的原生控件例如你可以拥有一个包含原生顶部导航栏的页面该导航栏下方是一个占据剩余空间的这需要更深入地了解页面布局和导航代码共享策略与应用共享类库这是实现最大代码重用的关键创建一个新的项目将共享的组件文件布局样式文件夹在中和逻辑移到这个中让你的应用和你的应用或都引用这个项目在应用中静态资源如中的需要正确配置才能被找到通常构建过程会处理好这个问题但确保正确引用了聚合的样式表如共享业务逻辑纯业务逻辑服务模型帮助类可以放在标准的类库项目中然后被应用和任何其他应用包括应用等引用调试应用代码可以像调试任何或应用一样在中设置断点并进行调试内容在上如果启用了开发者工具通常可以在上右键单击并选择或取决于的行为来打开浏览器开发工具在上需要启用的开发者菜单然后在运行的应用中的上下文菜单中选择和调试内容可能需要特定平台的工具和配置例如的或部署应用的部署遵循标准的部署流程创建签名的或包然后分发到或侧载需要开发者账户通过或或上的配对连接归档和分发到或进行企业分发可以创建包或安装程序并通过或直接分发可以使用打包分发到或直接部署适用场景开发者希望构建原生应用如果你已经熟悉和技术这是进入原生移动和桌面开发的一条平滑路径代码重用是关键当你需要为桌面和移动平台提供类似的用户体验和功能时应用需要丰富的同时结合原生功能当标准应用无法满足对设备功能的访问需求时现有应用的扩展将现有的应用打包成本地应用并增强其原生功能原型设计和快速开发利用技术的快速迭代优势来构建跨平台应用局限性与考量原生观感是通过技术渲染的可能无法达到特定平台的原生观感除非投入大量精力进行定制以模仿原生控件性能虽然现代控件性能优越但在非常复杂或性能要求极高的场景下其性能可能不如纯原生在低端设备上尤其需要注意应用包大小应用包中需要包含资源和的相关依赖这可能会比纯原生应用略大平台差异尽管和努力提供跨平台一致性但在访问某些非常底层的原生功能或处理特定平台的怪癖时仍可能需要编写平台特定的代码启动时间第一次加载并初始化应用可能比纯原生页面略慢尽管后续导航通常很快总结提供了一种强大而灵活的方式让开发者能够利用他们现有的技能和代码库来构建功能齐全可以访问原生设备功能的多平台桌面和移动应用程序通过将的能力与的原生平台访问能力相结合开发者可以高效地创建丰富的用户体验同时最大限度地实现代码共享',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-05-12 02:29:13',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">Welcome To LifeTech's Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CSharp%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">CSharp学习<sup>3</sup></a><a href="/tags/IDE%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 1.05rem;">IDE常用快捷键<sup>2</sup></a><a href="/tags/Rust%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">Rust基础知识<sup>21</sup></a><a href="/tags/csharp%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">csharp相关学习<sup>5</sup></a><a href="/tags/docker%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">docker学习<sup>1</sup></a><a href="/tags/hexo%E5%8D%9A%E5%AE%A2%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4/" style="font-size: 1.05rem;">hexo博客常见命令<sup>1</sup></a><a href="/tags/python%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">python相关学习<sup>4</sup></a><a href="/tags/tauri%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">tauri基础知识<sup>1</sup></a><a href="/tags/xmake%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">xmake学习<sup>3</sup></a><a href="/tags/%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">个人学习<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">前端学习<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" style="font-size: 1.05rem;">数据分析<sup>1</sup></a><a href="/tags/%E6%97%A0%E7%BA%BF%E8%B0%83%E8%AF%95/" style="font-size: 1.05rem;">无线调试<sup>1</sup></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">深度学习<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" style="font-size: 1.05rem;">系统常用命令<sup>2</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 1.05rem;">系统常用快捷键<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">32</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="article-meta tags"><a class="article-meta__tags" href="/tags/csharp%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>csharp相关学习</span></a></span></div></div><h1 class="post-title" itemprop="name headline">blazor maui基础知识</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-05-11T18:16:12.000Z" title="发表于 2025-05-12 02:16:12">2025-05-12</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-05-11T18:29:13.149Z" title="更新于 2025-05-12 02:29:13">2025-05-12</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为无锡"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>无锡</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/05/12/blazor-maui%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"><header><a href="/tags/csharp%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" tabindex="-1" itemprop="url">csharp相关学习</a><h1 id="CrawlerTitle" itemprop="name headline">blazor maui基础知识</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Jackey Zhou</span><time itemprop="dateCreated datePublished" datetime="2025-05-11T18:16:12.000Z" title="发表于 2025-05-12 02:16:12">2025-05-12</time><time itemprop="dateCreated datePublished" datetime="2025-05-11T18:29:13.149Z" title="更新于 2025-05-12 02:29:13">2025-05-12</time></header><p><strong>目录</strong></p>
<ol>
<li><a href="#1-%E7%AE%80%E4%BB%8B">简介</a><ul>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-net-maui">什么是 .NET MAUI?</a></li>
<li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-blazor-hybrid">什么是 Blazor Hybrid?</a></li>
<li><a href="#net-maui-blazor-hybrid-%E7%9A%84%E6%A0%B8%E5%BF%83%E6%80%9D%E6%83%B3">.NET MAUI Blazor Hybrid 的核心思想</a></li>
</ul>
</li>
<li><a href="#2-%E4%B8%BA%E4%BD%95%E9%80%89%E6%8B%A9-net-maui-blazor-hybrid-%E4%BC%98%E5%8A%BF">为何选择 .NET MAUI Blazor Hybrid? (优势)</a></li>
<li><a href="#3-%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83">搭建开发环境</a></li>
<li><a href="#4-%E5%88%9B%E5%BB%BA%E7%AC%AC%E4%B8%80%E4%B8%AA-net-maui-blazor-%E5%BA%94%E7%94%A8">创建第一个 .NET MAUI Blazor 应用</a><ul>
<li><a href="#%E4%BD%BF%E7%94%A8-visual-studio">使用 Visual Studio</a></li>
<li><a href="#%E4%BD%BF%E7%94%A8-net-cli">使用 .NET CLI</a></li>
<li><a href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%A3%E6%9E%90">项目结构解析</a></li>
</ul>
</li>
<li><a href="#5-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6-blazorwebview">核心组件: <code>BlazorWebView</code></a><ul>
<li><a href="#hostpage-%E5%B1%9E%E6%80%A7"><code>HostPage</code> 属性</a></li>
<li><a href="#rootcomponents-%E9%9B%86%E5%90%88"><code>RootComponents</code> 集合</a></li>
<li><a href="#%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE-mauiprogramcs">服务配置 (<code>MauiProgram.cs</code>)</a></li>
</ul>
</li>
<li><a href="#6-%E4%BD%BF%E7%94%A8-blazor-%E6%9E%84%E5%BB%BA%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2">使用 Blazor 构建用户界面</a><ul>
<li><a href="#razor-%E7%BB%84%E4%BB%B6-razor">Razor 组件 (<code>.razor</code>)</a></li>
<li><a href="#%E5%B8%83%E5%B1%80-layouts">布局 (Layouts)</a></li>
<li><a href="#%E8%B7%AF%E7%94%B1-routing">路由 (Routing)</a></li>
<li><a href="#%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E4%B8%8E%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86">数据绑定与事件处理</a></li>
<li><a href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-di">依赖注入 (DI)</a></li>
</ul>
</li>
<li><a href="#7-%E8%AE%BF%E9%97%AE%E6%9C%AC%E6%9C%BA%E8%AE%BE%E5%A4%87%E5%8A%9F%E8%83%BD-native-device-features">访问本机设备功能 (Native Device Features)</a><ul>
<li><a href="#%E9%80%9A%E7%94%A8%E6%96%B9%E6%B3%95%E6%8A%BD%E8%B1%A1%E4%B8%8E%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%85%A5">通用方法：抽象与服务注入</a></li>
<li><a href="#net-maui-essentials">.NET MAUI Essentials</a></li>
<li><a href="#%E7%A4%BA%E4%BE%8B1-%E8%8E%B7%E5%8F%96%E8%AE%BE%E5%A4%87%E4%BF%A1%E6%81%AF">示例 1: 获取设备信息</a></li>
<li><a href="#%E7%A4%BA%E4%BE%8B2-%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE">示例 2: 地理位置</a></li>
<li><a href="#%E7%A4%BA%E4%BE%8B3-%E8%B0%83%E7%94%A8%E5%B9%B3%E5%8F%B0%E7%89%B9%E5%AE%9A-api-%E9%83%A8%E5%88%86%E7%B1%BB%E4%B8%8E%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91">示例 3: 调用平台特定 API (部分类与条件编译)</a></li>
<li><a href="#%E4%BB%8E-blazor-%E7%BB%84%E4%BB%B6%E8%B0%83%E7%94%A8%E5%8E%9F%E7%94%9F%E5%8A%9F%E8%83%BD">从 Blazor 组件调用原生功能</a></li>
</ul>
</li>
<li><a href="#8-javascript-%E4%BA%92%E6%93%8D%E4%BD%9C-js-interop">JavaScript 互操作 (JS Interop)</a><ul>
<li><a href="#%E4%BB%8E-net-%E8%B0%83%E7%94%A8-javascript">从 .NET 调用 JavaScript</a></li>
<li><a href="#%E4%BB%8E-javascript-%E8%B0%83%E7%94%A8-net">从 JavaScript 调用 .NET</a></li>
</ul>
</li>
<li><a href="#9-%E6%A0%B7%E5%BC%8F%E5%8C%96%E5%BA%94%E7%94%A8">样式化应用</a><ul>
<li><a href="#%E5%85%A8%E5%B1%80%E6%A0%B7%E5%BC%8F-wwwrootcss">全局样式 (<code>wwwroot/css</code>)</a></li>
<li><a href="#%E7%BB%84%E4%BB%B6%E4%BD%9C%E7%94%A8%E5%9F%9F-css-razorcss">组件作用域 CSS (<code>.razor.css</code>)</a></li>
<li><a href="#%E6%B7%B7%E5%90%88%E5%8E%9F%E7%94%9F-ui-%E5%85%83%E7%B4%A0-%E9%AB%98%E7%BA%A7">混合原生 UI 元素 (高级)</a></li>
</ul>
</li>
<li><a href="#10-%E4%BB%A3%E7%A0%81%E5%85%B1%E4%BA%AB%E7%AD%96%E7%95%A5">代码共享策略</a><ul>
<li><a href="#%E4%B8%8E-blazor-web-%E5%BA%94%E7%94%A8%E5%85%B1%E4%BA%AB-razor-%E7%B1%BB%E5%BA%93-rcl">与 Blazor Web 应用共享 Razor 类库 (RCL)</a></li>
<li><a href="#%E5%85%B1%E4%BA%AB%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91">共享业务逻辑</a></li>
</ul>
</li>
<li><a href="#11-%E8%B0%83%E8%AF%95-net-maui-blazor-%E5%BA%94%E7%94%A8">调试 .NET MAUI Blazor 应用</a></li>
<li><a href="#12-%E9%83%A8%E7%BD%B2">部署</a></li>
<li><a href="#13-net-maui-blazor-hybrid-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF">.NET MAUI Blazor Hybrid 适用场景</a></li>
<li><a href="#14-%E5%B1%80%E9%99%90%E6%80%A7%E4%B8%8E%E8%80%83%E9%87%8F">局限性与考量</a></li>
<li><a href="#15-%E6%80%BB%E7%BB%93">总结</a></li>
</ol>
<hr>
<h2 id="1-简介"><a href="#1-简介" class="headerlink" title="1. 简介"></a>1. 简介</h2><h3 id="什么是-NET-MAUI"><a href="#什么是-NET-MAUI" class="headerlink" title="什么是 .NET MAUI?"></a>什么是 .NET MAUI?</h3><p>.NET Multi-platform App UI (.NET MAUI) 是一个跨平台的框架，用于使用 C# 和 XAML (或仅 C#) 创建原生的移动和桌面应用程序。它从 Xamarin.Forms 演变而来，允许开发者从单个共享代码库为 Android、iOS、macOS 和 Windows 构建应用程序。</p>
<h3 id="什么是-Blazor-Hybrid"><a href="#什么是-Blazor-Hybrid" class="headerlink" title="什么是 Blazor Hybrid?"></a>什么是 Blazor Hybrid?</h3><p>Blazor Hybrid 是一种将 Blazor (一个用于使用 .NET 构建交互式客户端 Web UI 的框架) 与原生客户端应用程序框架（如 .NET MAUI, WPF, Windows Forms）结合起来的方法。它允许开发者在原生应用中嵌入和渲染 Blazor Razor 组件。</p>
<h3 id="NET-MAUI-Blazor-Hybrid-的核心思想"><a href="#NET-MAUI-Blazor-Hybrid-的核心思想" class="headerlink" title=".NET MAUI Blazor Hybrid 的核心思想"></a>.NET MAUI Blazor Hybrid 的核心思想</h3><p>.NET MAUI Blazor Hybrid 的核心思想是让开发者能够<strong>重用 Blazor Web UI 组件</strong>来构建功能齐全的<strong>原生桌面和移动应用程序</strong>。这些 Blazor 组件不是在浏览器沙箱中运行，而是直接在 .NET 进程中本地运行，并使用嵌入式 Web View 控件（如 Windows 上的 WebView2，macOS 上的 WKWebView，Android 上的 WebView，iOS 上的 WKWebView）来渲染 Web UI (HTML, CSS)。关键在于，尽管 UI 是通过 Web 技术渲染的，但 Blazor 代码可以直接、完全地访问<strong>本机设备功能</strong>和资源。</p>
<h2 id="2-为何选择-NET-MAUI-Blazor-Hybrid-优势"><a href="#2-为何选择-NET-MAUI-Blazor-Hybrid-优势" class="headerlink" title="2. 为何选择 .NET MAUI Blazor Hybrid? (优势)"></a>2. 为何选择 .NET MAUI Blazor Hybrid? (优势)</h2><ul>
<li><strong>代码重用</strong>:<ul>
<li>在 Web、桌面和移动应用之间共享 Blazor 组件、样式和业务逻辑。</li>
<li>利用现有的 Blazor Web 开发技能和生态系统。</li>
</ul>
</li>
<li><strong>原生功能访问</strong>:<ul>
<li>通过 .NET MAUI 的 API 和 .NET 平台，可以直接从 C# Blazor 代码中访问完整的原生设备功能（如摄像头、GPS、文件系统、传感器等）。</li>
<li>无需复杂的 JavaScript 桥接层来访问大多数原生功能。</li>
</ul>
</li>
<li><strong>Web 技术的灵活性</strong>:<ul>
<li>利用 HTML, CSS, 和 C# (通过 Blazor) 来构建美观、响应式的用户界面。</li>
<li>可以使用现有的 CSS 框架和 Web 设计知识。</li>
</ul>
</li>
<li><strong>单一代码库</strong>:<ul>
<li>使用 C# 和 .NET 为所有目标平台（Web、Windows、macOS、Android、iOS）维护一个主要的代码库。</li>
</ul>
</li>
<li><strong>性能</strong>:<ul>
<li>Blazor 组件在 .NET 进程中本地运行，避免了像 Blazor WebAssembly 那样的 .NET 运行时下载或像 Blazor Server 那样的网络延迟。UI 渲染在高效的现代 Web View 控件中进行。</li>
</ul>
</li>
<li><strong>现代开发体验</strong>:<ul>
<li>享受 .NET 和 Visual Studio (或 VS Code) 提供的强大工具、库和社区支持。</li>
</ul>
</li>
<li><strong>逐步迁移&#x2F;集成</strong>:<ul>
<li>可以将现有的 Blazor Web 应用的部分或全部 UI 迁移到原生移动&#x2F;桌面应用。</li>
</ul>
</li>
</ul>
<h2 id="3-搭建开发环境"><a href="#3-搭建开发环境" class="headerlink" title="3. 搭建开发环境"></a>3. 搭建开发环境</h2><p>要开始 .NET MAUI Blazor 开发，你需要：</p>
<ol>
<li><strong>.NET SDK</strong>: 安装最新版本的 .NET SDK (推荐 .NET 8 或更新版本)。</li>
<li><strong>Visual Studio 2022 (或更高版本)</strong>:<ul>
<li>确保安装了 “.NET Multi-platform App UI development” 工作负载。</li>
<li>对于 iOS 和 macOS 开发，需要一台 macOS 构建主机，并安装 Xcode。</li>
<li>对于 Android 开发，需要 Android SDK 和模拟器&#x2F;设备。</li>
</ul>
</li>
<li><strong>(可选) Visual Studio Code</strong>:<ul>
<li>安装 C# Dev Kit 和 .NET MAUI 扩展。</li>
<li>命令行工具对于 VS Code 用户更为重要。</li>
</ul>
</li>
</ol>
<p>检查 .NET MAUI 安装是否完整：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet workload list</span><br><span class="line">dotnet workload install maui</span><br></pre></td></tr></table></figure>

<h2 id="4-创建第一个-NET-MAUI-Blazor-应用"><a href="#4-创建第一个-NET-MAUI-Blazor-应用" class="headerlink" title="4. 创建第一个 .NET MAUI Blazor 应用"></a>4. 创建第一个 .NET MAUI Blazor 应用</h2><h3 id="使用-Visual-Studio"><a href="#使用-Visual-Studio" class="headerlink" title="使用 Visual Studio"></a>使用 Visual Studio</h3><ol>
<li>打开 Visual Studio。</li>
<li>选择 “创建新项目”。</li>
<li>搜索并选择 “.NET MAUI Blazor App” 模板。</li>
<li>配置项目名称和位置，然后点击 “创建”。</li>
</ol>
<h3 id="使用-NET-CLI"><a href="#使用-NET-CLI" class="headerlink" title="使用 .NET CLI"></a>使用 .NET CLI</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">dotnet new maui-blazor -o MyMauiBlazorApp</span><br><span class="line"><span class="built_in">cd</span> MyMauiBlazorApp</span><br></pre></td></tr></table></figure>

<h3 id="项目结构解析"><a href="#项目结构解析" class="headerlink" title="项目结构解析"></a>项目结构解析</h3><p>一个典型的 .NET MAUI Blazor 项目包含以下关键部分：</p>
<ul>
<li><p><strong><code>MauiProgram.cs</code></strong>: 应用程序的入口点。在这里配置服务、字体、处理程序以及注册 <code>BlazorWebView</code>。</p>
</li>
<li><p><strong><code>App.xaml</code> &#x2F; <code>App.xaml.cs</code></strong>: 定义应用程序范围的资源和行为，通常用于设置主窗口。</p>
</li>
<li><p><strong><code>MainPage.xaml</code> &#x2F; <code>MainPage.xaml.cs</code></strong>: 默认的主页面，通常包含 <code>BlazorWebView</code> 控件来托管 Blazor 内容。</p>
<ul>
<li><p><code>MainPage.xaml</code>:</p>
<figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">ContentPage</span> <span class="attr">xmlns</span>=<span class="string">&quot;http://schemas.microsoft.com/dotnet/2021/maui&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">xmlns:x</span>=<span class="string">&quot;http://schemas.microsoft.com/winfx/2009/xaml&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">xmlns:local</span>=<span class="string">&quot;clr-namespace:MyMauiBlazorApp&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">x:Class</span>=<span class="string">&quot;MyMauiBlazorApp.MainPage&quot;</span></span></span><br><span class="line"><span class="tag">             <span class="attr">BackgroundColor</span>=<span class="string">&quot;&#123;DynamicResource PageBackgroundColor&#125;&quot;</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">BlazorWebView</span> <span class="attr">x:Name</span>=<span class="string">&quot;blazorWebView&quot;</span> <span class="attr">HostPage</span>=<span class="string">&quot;wwwroot/index.html&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">BlazorWebView.RootComponents</span>&gt;</span></span><br><span class="line">            <span class="tag">&lt;<span class="name">RootComponent</span> <span class="attr">Selector</span>=<span class="string">&quot;#app&quot;</span> <span class="attr">ComponentType</span>=<span class="string">&quot;&#123;x:Type local:Components.Routes&#125;&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">BlazorWebView.RootComponents</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">BlazorWebView</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;/<span class="name">ContentPage</span>&gt;</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong><code>Components/</code></strong> 文件夹:</p>
<ul>
<li><strong><code>Layout/</code></strong>: 包含 Blazor 布局组件 (如 <code>MainLayout.razor</code>, <code>NavMenu.razor</code>)。</li>
<li><strong><code>Pages/</code></strong>: 包含 Blazor 页面组件 (如 <code>Home.razor</code>, <code>Counter.razor</code>)。</li>
<li><strong><code>Routes.razor</code></strong>: (.NET 8+) 定义 Blazor 路由和默认布局。在旧版本中，这部分逻辑可能在 <code>App.razor</code> (如果项目是从旧模板升级的) 或直接由 <code>RootComponent</code> 指向单个页面&#x2F;布局组件。</li>
</ul>
</li>
<li><p><strong><code>wwwroot/</code></strong>: 包含静态 Web 资源。</p>
<ul>
<li><code>index.html</code>: Blazor 应用的宿主 HTML 页面。</li>
<li><code>css/</code>: 包含全局 CSS 文件 (如 <code>app.css</code>, <code>bootstrap/bootstrap.min.css</code>)。</li>
<li>JavaScript 文件、图像等。</li>
</ul>
</li>
<li><p><strong><code>Platforms/</code></strong>: 包含特定平台的代码和资源 (Android, iOS, macOS, Windows)。</p>
</li>
<li><p><strong><code>Resources/</code></strong>: 包含应用共享资源，如图像、字体、应用图标、启动画面。</p>
</li>
<li><p><strong><code>_Imports.razor</code></strong>: 全局的 Razor <code>@using</code> 指令。</p>
</li>
<li><p><strong><code>.csproj</code> 文件</strong>: 项目配置文件，指定目标框架、依赖项等。</p>
</li>
</ul>
<h2 id="5-核心组件-BlazorWebView"><a href="#5-核心组件-BlazorWebView" class="headerlink" title="5. 核心组件: BlazorWebView"></a>5. 核心组件: <code>BlazorWebView</code></h2><p><code>BlazorWebView</code> 是 .NET MAUI 中的一个控件，用于在其内部承载 Blazor Web 内容。</p>
<h3 id="HostPage-属性"><a href="#HostPage-属性" class="headerlink" title="HostPage 属性"></a><code>HostPage</code> 属性</h3><p>指定作为 Blazor 应用宿主的静态 HTML 文件的路径。通常是 <code>wwwroot/index.html</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;!DOCTYPE <span class="keyword">html</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">html</span> <span class="attr">lang</span>=<span class="string">&quot;en&quot;</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">head</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span> <span class="attr">charset</span>=<span class="string">&quot;utf-8&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">meta</span></span></span><br><span class="line"><span class="tag">      <span class="attr">name</span>=<span class="string">&quot;viewport&quot;</span></span></span><br><span class="line"><span class="tag">      <span class="attr">content</span>=<span class="string">&quot;width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover&quot;</span></span></span><br><span class="line"><span class="tag">    /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">title</span>&gt;</span>MyMauiBlazorApp<span class="tag">&lt;/<span class="name">title</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">base</span> <span class="attr">href</span>=<span class="string">&quot;/&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/bootstrap/bootstrap.min.css&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;css/app.css&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">href</span>=<span class="string">&quot;MyMauiBlazorApp.styles.css&quot;</span> /&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;icon&quot;</span> <span class="attr">type</span>=<span class="string">&quot;image/png&quot;</span> <span class="attr">href</span>=<span class="string">&quot;favicon.png&quot;</span> /&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">head</span>&gt;</span></span><br><span class="line"></span><br><span class="line">  <span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;status-bar-safe-area&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;app&quot;</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">svg</span> <span class="attr">class</span>=<span class="string">&quot;loading-progress&quot;</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">circle</span> <span class="attr">r</span>=<span class="string">&quot;40%&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;50%&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;50%&quot;</span> /&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">circle</span> <span class="attr">r</span>=<span class="string">&quot;40%&quot;</span> <span class="attr">cx</span>=<span class="string">&quot;50%&quot;</span> <span class="attr">cy</span>=<span class="string">&quot;50%&quot;</span> /&gt;</span></span><br><span class="line">      <span class="tag">&lt;/<span class="name">svg</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">&quot;loading-progress-text&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;blazor-error-ui&quot;</span>&gt;</span></span><br><span class="line">      An unhandled error has occurred.</span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">href</span>=<span class="string">&quot;&quot;</span> <span class="attr">class</span>=<span class="string">&quot;reload&quot;</span>&gt;</span>Reload<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">a</span> <span class="attr">class</span>=<span class="string">&quot;dismiss&quot;</span>&gt;</span>🗙<span class="tag">&lt;/<span class="name">a</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;_framework/blazor.webview.js&quot;</span> <span class="attr">autostart</span>=<span class="string">&quot;false&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">html</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>_framework/blazor.webview.js</code> 是 Blazor Hybrid 的核心脚本，用于初始化和管理 Blazor 应用与原生宿主之间的通信。<code>autostart=&quot;false&quot;</code> 通常与在 <code>MauiProgram.cs</code> 中配置启动结合使用。</p>
<h3 id="RootComponents-集合"><a href="#RootComponents-集合" class="headerlink" title="RootComponents 集合"></a><code>RootComponents</code> 集合</h3><p>指定要加载到 <code>HostPage</code> 中的根 Blazor 组件。</p>
<ul>
<li><strong><code>Selector</code></strong>: 一个 CSS 选择器，指定 <code>HostPage</code> 中根组件应渲染到的 HTML 元素 (通常是 <code>#app</code>)。</li>
<li><strong><code>ComponentType</code></strong>: 要渲染的根 Blazor 组件的类型 (例如 <code>Components.Routes</code> 或 <code>App</code>)。</li>
<li><strong><code>Parameters</code></strong>: (可选) 一个字典，用于将初始参数传递给根组件。</li>
</ul>
<h3 id="服务配置-MauiProgram-cs"><a href="#服务配置-MauiProgram-cs" class="headerlink" title="服务配置 (MauiProgram.cs)"></a>服务配置 (<code>MauiProgram.cs</code>)</h3><p><code>MauiProgram.cs</code> 是配置 Blazor Hybrid 功能的关键位置。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MauiProgram.cs</span></span><br><span class="line"><span class="keyword">using</span> Microsoft.Extensions.Logging;</span><br><span class="line"><span class="keyword">using</span> MyMauiBlazorApp.Data; <span class="comment">// Example data service</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MauiProgram</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> MauiApp <span class="title">CreateMauiApp</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">var</span> builder = MauiApp.CreateBuilder();</span><br><span class="line">        builder</span><br><span class="line">            .UseMauiApp&lt;App&gt;()</span><br><span class="line">            .ConfigureFonts(fonts =&gt;</span><br><span class="line">            &#123;</span><br><span class="line">                fonts.AddFont(<span class="string">&quot;OpenSans-Regular.ttf&quot;</span>, <span class="string">&quot;OpenSansRegular&quot;</span>);</span><br><span class="line">            &#125;);</span><br><span class="line"></span><br><span class="line">        builder.Services.AddMauiBlazorWebView(); <span class="comment">// 注册 BlazorWebView 服务</span></span><br><span class="line"></span><br><span class="line">        <span class="meta">#<span class="keyword">if</span> DEBUG</span></span><br><span class="line">        builder.Services.AddBlazorWebViewDeveloperTools(); <span class="comment">// 添加 Blazor Web View 开发工具</span></span><br><span class="line">        builder.Logging.AddDebug();</span><br><span class="line">        <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line"></span><br><span class="line">        <span class="comment">// 注册 Blazor 和应用服务</span></span><br><span class="line">        builder.Services.AddSingleton&lt;WeatherForecastService&gt;();</span><br><span class="line">        <span class="comment">// 注册任何你需要的其他服务，比如原生功能访问服务</span></span><br><span class="line">        <span class="comment">// builder.Services.AddSingleton&lt;IMyNativeService, MyNativeServiceImplementation&gt;();</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> builder.Build();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><code>AddMauiBlazorWebView()</code> 注册了 <code>BlazorWebView</code> 正常运行所需的核心服务。<code>AddBlazorWebViewDeveloperTools()</code> 启用了在浏览器中进行调试的功能 (通常通过右键单击 WebView 并选择“检查”或类似选项)。</p>
<h2 id="6-使用-Blazor-构建用户界面"><a href="#6-使用-Blazor-构建用户界面" class="headerlink" title="6. 使用 Blazor 构建用户界面"></a>6. 使用 Blazor 构建用户界面</h2><p>在 .NET MAUI Blazor Hybrid 应用中构建 UI 的方式与标准 Blazor Web 应用几乎完全相同。</p>
<h3 id="Razor-组件-razor"><a href="#Razor-组件-razor" class="headerlink" title="Razor 组件 (.razor)"></a>Razor 组件 (<code>.razor</code>)</h3><p>UI 由可重用的 Razor 组件构成，这些组件结合了 HTML 标记和 C# 逻辑。</p>
<h3 id="布局-Layouts"><a href="#布局-Layouts" class="headerlink" title="布局 (Layouts)"></a>布局 (Layouts)</h3><p>使用 Blazor 布局组件 (<code>MainLayout.razor</code>) 来定义通用的 UI 结构 (如导航菜单、页眉、页脚)。</p>
<h3 id="路由-Routing"><a href="#路由-Routing" class="headerlink" title="路由 (Routing)"></a>路由 (Routing)</h3><p>Blazor 路由 (<code>@page</code> 指令) 用于在应用内导航。根路由组件 (如 <code>Components/Routes.razor</code> 或旧模板中的 <code>App.razor</code>) 会配置路由。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">// Components/Routes.razor</span><br><span class="line">&lt;Router AppAssembly=&quot;typeof(Routes).Assembly&quot;&gt;</span><br><span class="line">    &lt;Found Context=&quot;routeData&quot;&gt;</span><br><span class="line">        &lt;RouteView RouteData=&quot;routeData&quot; DefaultLayout=&quot;typeof(Layout.MainLayout)&quot; /&gt;</span><br><span class="line">        &lt;FocusOnNavigate RouteData=&quot;routeData&quot; Selector=&quot;h1&quot; /&gt;</span><br><span class="line">    &lt;/Found&gt;</span><br><span class="line">    &lt;NotFound&gt;</span><br><span class="line">        &lt;LayoutView Layout=&quot;typeof(Layout.MainLayout)&quot;&gt;</span><br><span class="line">            &lt;p role=&quot;alert&quot;&gt;Sorry, there&#x27;s nothing at this address.&lt;/p&gt;</span><br><span class="line">        &lt;/LayoutView&gt;</span><br><span class="line">    &lt;/NotFound&gt;</span><br><span class="line">&lt;/Router&gt;</span><br></pre></td></tr></table></figure>

<h3 id="数据绑定与事件处理"><a href="#数据绑定与事件处理" class="headerlink" title="数据绑定与事件处理"></a>数据绑定与事件处理</h3><p>Blazor 的数据绑定 (<code>@bind</code>) 和事件处理 (<code>@onclick</code>, <code>@onchange</code> 等) 机制在 Hybrid 应用中同样适用。</p>
<h3 id="依赖注入-DI"><a href="#依赖注入-DI" class="headerlink" title="依赖注入 (DI)"></a>依赖注入 (DI)</h3><p>Blazor 的依赖注入系统允许你将服务（包括访问原生功能的服务）注入到你的 Razor 组件中。</p>
<h2 id="7-访问本机设备功能-Native-Device-Features"><a href="#7-访问本机设备功能-Native-Device-Features" class="headerlink" title="7. 访问本机设备功能 (Native Device Features)"></a>7. 访问本机设备功能 (Native Device Features)</h2><p>这是 .NET MAUI Blazor Hybrid 的核心优势之一。你的 C# Blazor 代码可以直接调用原生 API。</p>
<h3 id="通用方法：抽象与服务注入"><a href="#通用方法：抽象与服务注入" class="headerlink" title="通用方法：抽象与服务注入"></a>通用方法：抽象与服务注入</h3><p>最佳实践是创建一个抽象接口，然后提供特定平台的实现或使用 .NET MAUI 提供的跨平台实现。然后将此服务注入到 Blazor 组件中。</p>
<h3 id="NET-MAUI-Essentials"><a href="#NET-MAUI-Essentials" class="headerlink" title=".NET MAUI Essentials"></a>.NET MAUI Essentials</h3><p>.NET MAUI 包含一组名为 .NET MAUI Essentials 的 API，这些 API 提供了对常见原生功能的跨平台访问，例如：</p>
<ul>
<li>Accelerometer, Barometer, Compass, Gyroscope, Magnetometer</li>
<li>AppInfo, AppTheme, Battery, Connectivity, DeviceDisplay, DeviceInfo</li>
<li>Email, FilePicker, FileSystem, Geocoding, Geolocation, HapticFeedback, Launcher</li>
<li>Maps, Permissions, PhoneDialer, Preferences, ScreenShot, SecureStorage, Share, SMS, TextToSpeech, VersionTracking, Vibration</li>
</ul>
<h3 id="示例-1-获取设备信息"><a href="#示例-1-获取设备信息" class="headerlink" title="示例 1: 获取设备信息"></a>示例 1: 获取设备信息</h3><ol>
<li><p><strong>无需额外服务，可以直接使用 <code>DeviceInfo</code></strong>:</p>
</li>
<li><p><strong>在 Blazor 组件中使用 (<code>.razor</code>):</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">@page &quot;/deviceinfo&quot;</span><br><span class="line">@using Microsoft.Maui.Devices</span><br><span class="line"></span><br><span class="line">&lt;h3&gt;Device Information&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">@if (IsLoaded)</span><br><span class="line">&#123;</span><br><span class="line">    &lt;p&gt;&lt;strong&gt;Model:&lt;/strong&gt; @DeviceInfo.Current.Model&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;strong&gt;Manufacturer:&lt;/strong&gt; @DeviceInfo.Current.Manufacturer&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;strong&gt;Name:&lt;/strong&gt; @DeviceInfo.Current.Name&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;strong&gt;OS Version:&lt;/strong&gt; @DeviceInfo.Current.VersionString&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;strong&gt;Platform:&lt;/strong&gt; @DeviceInfo.Current.Platform&#125;&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;strong&gt;Idiom:&lt;/strong&gt; @DeviceInfo.Current.Idiom&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;&lt;strong&gt;Device Type:&lt;/strong&gt; @(DeviceInfo.Current.DeviceType == DeviceType.Virtual ? &quot;Virtual&quot; : &quot;Physical&quot;)&lt;/p&gt;</span><br><span class="line">&#125;</span><br><span class="line">else</span><br><span class="line">&#123;</span><br><span class="line">    &lt;p&gt;Loading device info...&lt;/p&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">@code &#123;</span><br><span class="line">    private bool IsLoaded = false;</span><br><span class="line"></span><br><span class="line">    protected override void OnInitialized()</span><br><span class="line">    &#123;</span><br><span class="line">        // DeviceInfo is readily available</span><br><span class="line">        IsLoaded = true;</span><br><span class="line">        base.OnInitialized();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="示例-2-地理位置"><a href="#示例-2-地理位置" class="headerlink" title="示例 2: 地理位置"></a>示例 2: 地理位置</h3><ol>
<li><p><strong>创建服务接口 (可选，但推荐用于解耦和测试):</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Interfaces/IGeolocationService.cs</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IGeolocationService</span></span><br><span class="line">&#123;</span><br><span class="line">    Task&lt;Location?&gt; GetCurrentLocationAsync();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>创建服务实现:</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Services/MauiGeolocationService.cs</span></span><br><span class="line"><span class="keyword">using</span> Microsoft.Maui.Devices.Sensors; <span class="comment">// For Geolocation</span></span><br><span class="line"><span class="comment">// using YourProject.Interfaces;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">MauiGeolocationService</span> : <span class="title">IGeolocationService</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">async</span> Task&lt;Location?&gt; GetCurrentLocationAsync()</span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">try</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 检查并请求权限</span></span><br><span class="line">            <span class="keyword">var</span> status = <span class="keyword">await</span> Permissions.CheckStatusAsync&lt;Permissions.LocationWhenInUse&gt;();</span><br><span class="line">            <span class="keyword">if</span> (status != PermissionStatus.Granted)</span><br><span class="line">            &#123;</span><br><span class="line">                status = <span class="keyword">await</span> Permissions.RequestAsync&lt;Permissions.LocationWhenInUse&gt;();</span><br><span class="line">                <span class="keyword">if</span> (status != PermissionStatus.Granted)</span><br><span class="line">                    <span class="keyword">return</span> <span class="literal">null</span>; <span class="comment">// 用户未授予权限</span></span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> request = <span class="keyword">new</span> GeolocationRequest(GeolocationAccuracy.Medium, TimeSpan.FromSeconds(<span class="number">10</span>));</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> Geolocation.GetLocationAsync(request);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (FeatureNotSupportedException fnsEx)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 处理设备不支持地理位置的情况</span></span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Geolocation not supported: <span class="subst">&#123;fnsEx.Message&#125;</span>&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (PermissionException pEx)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 处理权限问题</span></span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Geolocation permission error: <span class="subst">&#123;pEx.Message&#125;</span>&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">catch</span> (Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// 处理其他异常</span></span><br><span class="line">            Console.WriteLine(<span class="string">$&quot;Unable to get location: <span class="subst">&#123;ex.Message&#125;</span>&quot;</span>);</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">null</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>在 <code>MauiProgram.cs</code> 中注册服务:</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddSingleton&lt;IGeolocationService, MauiGeolocationService&gt;();</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>在 Blazor 组件中注入并使用服务:</strong></p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br></pre></td><td class="code"><pre><span class="line">@page &quot;/geolocation&quot;</span><br><span class="line">@inject IGeolocationService GeoService</span><br><span class="line">@using Microsoft.Maui.Devices.Sensors // For Location type</span><br><span class="line"></span><br><span class="line">&lt;h3&gt;Geolocation&lt;/h3&gt;</span><br><span class="line"></span><br><span class="line">&lt;button @onclick=&quot;FetchLocation&quot;&gt;Get Current Location&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">@if (currentLocation != null)</span><br><span class="line">&#123;</span><br><span class="line">    &lt;p&gt;Latitude: @currentLocation.Latitude&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;Longitude: @currentLocation.Longitude&lt;/p&gt;</span><br><span class="line">    &lt;p&gt;Altitude: @(currentLocation.Altitude.HasValue ? currentLocation.Altitude.Value.ToString() : &quot;N/A&quot;)&lt;/p&gt;</span><br><span class="line">&#125;</span><br><span class="line">else if (isLoading)</span><br><span class="line">&#123;</span><br><span class="line">    &lt;p&gt;&lt;em&gt;Fetching location...&lt;/em&gt;&lt;/p&gt;</span><br><span class="line">&#125;</span><br><span class="line">else if (errorMessage != null)</span><br><span class="line">&#123;</span><br><span class="line">    &lt;p style=&quot;color:red;&quot;&gt;@errorMessage&lt;/p&gt;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">@code &#123;</span><br><span class="line">    private Location? currentLocation;</span><br><span class="line">    private bool isLoading = false;</span><br><span class="line">    private string? errorMessage;</span><br><span class="line"></span><br><span class="line">    private async Task FetchLocation()</span><br><span class="line">    &#123;</span><br><span class="line">        isLoading = true;</span><br><span class="line">        errorMessage = null;</span><br><span class="line">        currentLocation = null;</span><br><span class="line">        try</span><br><span class="line">        &#123;</span><br><span class="line">            currentLocation = await GeoService.GetCurrentLocationAsync();</span><br><span class="line">            if (currentLocation == null)</span><br><span class="line">            &#123;</span><br><span class="line">                errorMessage = &quot;Could not retrieve location. Please ensure permissions are granted.&quot;;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        catch(Exception ex)</span><br><span class="line">        &#123;</span><br><span class="line">            errorMessage = $&quot;Error: &#123;ex.Message&#125;&quot;;</span><br><span class="line">        &#125;</span><br><span class="line">        finally</span><br><span class="line">        &#123;</span><br><span class="line">            isLoading = false;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>注意权限</strong>: 地理位置等功能需要在特定平台的清单文件中声明权限（如 <code>AndroidManifest.xml</code> for Android, <code>Info.plist</code> for iOS）。.NET MAUI Essentials 的权限 API (<code>Permissions</code>类) 可以帮助检查和请求运行时权限。</p>
</li>
</ol>
<h3 id="示例-3-调用平台特定-API-部分类与条件编译"><a href="#示例-3-调用平台特定-API-部分类与条件编译" class="headerlink" title="示例 3: 调用平台特定 API (部分类与条件编译)"></a>示例 3: 调用平台特定 API (部分类与条件编译)</h3><p>有时，.NET MAUI Essentials 未涵盖你需要的功能，或者你需要更深层次的平台特定控制。</p>
<ol>
<li><p><strong>定义接口 (共享代码):</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Interfaces/IBatteryNotifier.cs</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">interface</span> <span class="title">IBatteryNotifier</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">event</span> EventHandler&lt;<span class="built_in">int</span>&gt; BatteryLevelChanged;</span><br><span class="line">    <span class="function"><span class="built_in">int</span> <span class="title">GetCurrentBatteryLevel</span>()</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">StartListening</span>()</span>;</span><br><span class="line">    <span class="function"><span class="keyword">void</span> <span class="title">StopListening</span>()</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>创建部分类实现 (共享代码):</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Services/BatteryNotifier.cs (Shared)</span></span><br><span class="line"><span class="comment">// using YourProject.Interfaces;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">BatteryNotifier</span> : <span class="title">IBatteryNotifier</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">event</span> EventHandler&lt;<span class="built_in">int</span>&gt; BatteryLevelChanged;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">OnBatteryLevelChanged</span>(<span class="params"><span class="built_in">int</span> level</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        BatteryLevelChanged?.Invoke(<span class="keyword">this</span>, level);</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">// GetCurrentBatteryLevel, StartListening, StopListening will be implemented</span></span><br><span class="line">    <span class="comment">// by platform-specific partial classes.</span></span><br><span class="line">    <span class="comment">// We can provide default or shared implementations if applicable.</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>提供平台特定实现 (Platforms&#x2F; 文件夹):</strong></p>
<ul>
<li><p><strong><code>Platforms/Android/BatteryNotifier.cs</code></strong>:</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// using YourProject.Interfaces; // if interface is in shared</span></span><br><span class="line"><span class="keyword">namespace</span> <span class="title">MyMauiBlazorApp.Services</span> <span class="comment">// Ensure namespace matches shared part</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">partial</span> <span class="keyword">class</span> <span class="title">BatteryNotifier</span> <span class="comment">// : IBatteryNotifier (already on shared part)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="comment">// Android specific implementation</span></span><br><span class="line">        <span class="keyword">private</span> BatteryBroadcastReceiver? _receiver;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">GetCurrentBatteryLevel</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="comment">// ... Android specific code to get battery level ...</span></span><br><span class="line">            <span class="comment">// Example (simplified):</span></span><br><span class="line">            <span class="keyword">var</span> bm = Android.App.Application.Context.GetSystemService(Android.Content.Context.BatteryService) <span class="keyword">as</span> Android.OS.BatteryManager;</span><br><span class="line">            <span class="keyword">return</span> bm?.GetIntProperty((<span class="built_in">int</span>)Android.OS.BatteryProperty.Capacity) ?? <span class="number">-1</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">StartListening</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (_receiver == <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                _receiver = <span class="keyword">new</span> BatteryBroadcastReceiver();</span><br><span class="line">                _receiver.BatteryLevelChangedInternal += (s, level) =&gt; OnBatteryLevelChanged(level);</span><br><span class="line">                 Android.App.Application.Context.RegisterReceiver(_receiver,</span><br><span class="line">                    <span class="keyword">new</span> Android.Content.IntentFilter(Android.Content.Intent.ActionBatteryChanged));</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">StopListening</span>()</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">if</span> (_receiver != <span class="literal">null</span>)</span><br><span class="line">            &#123;</span><br><span class="line">                Android.App.Application.Context.UnregisterReceiver(_receiver);</span><br><span class="line">                _receiver.BatteryLevelChangedInternal -= (s, level) =&gt; OnBatteryLevelChanged(level);</span><br><span class="line">                _receiver.Dispose();</span><br><span class="line">                _receiver = <span class="literal">null</span>;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">// Inner class for BroadcastReceiver</span></span><br><span class="line">        <span class="keyword">private</span> <span class="keyword">class</span> <span class="title">BatteryBroadcastReceiver</span> : <span class="title">Android.Content.BroadcastReceiver</span></span><br><span class="line">        &#123;</span><br><span class="line">            <span class="keyword">public</span> <span class="keyword">event</span> EventHandler&lt;<span class="built_in">int</span>&gt; BatteryLevelChangedInternal;</span><br><span class="line">            <span class="function"><span class="keyword">public</span> <span class="keyword">override</span> <span class="keyword">void</span> <span class="title">OnReceive</span>(<span class="params">Android.Content.Context? context, Android.Content.Intent? intent</span>)</span></span><br><span class="line">            &#123;</span><br><span class="line">                <span class="keyword">if</span> (intent != <span class="literal">null</span>)</span><br><span class="line">                &#123;</span><br><span class="line">                    <span class="built_in">int</span> level = intent.GetIntExtra(Android.OS.BatteryManager.ExtraLevel, <span class="number">-1</span>);</span><br><span class="line">                    <span class="built_in">int</span> scale = intent.GetIntExtra(Android.OS.BatteryManager.ExtraScale, <span class="number">-1</span>);</span><br><span class="line">                    <span class="keyword">if</span> (level != <span class="number">-1</span> &amp;&amp; scale != <span class="number">-1</span>)</span><br><span class="line">                    &#123;</span><br><span class="line">                        <span class="built_in">int</span> batteryPct = (<span class="built_in">int</span>)((level / (<span class="built_in">float</span>)scale) * <span class="number">100.0f</span>);</span><br><span class="line">                        BatteryLevelChangedInternal?.Invoke(<span class="keyword">this</span>, batteryPct);</span><br><span class="line">                    &#125;</span><br><span class="line">                &#125;</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>为 iOS, macOS, Windows 创建类似的平台特定部分类。</p>
</li>
</ul>
<p><strong>或者使用条件编译 (<code>#if</code>) 在单个文件中:</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// Services/BatteryNotifier.cs</span></span><br><span class="line"><span class="comment">// using YourProject.Interfaces;</span></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">class</span> <span class="title">BatteryNotifierWithConditionalCompilation</span> : <span class="title">IBatteryNotifier</span></span><br><span class="line">&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="keyword">event</span> EventHandler&lt;<span class="built_in">int</span>&gt; BatteryLevelChanged;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="built_in">int</span> <span class="title">GetCurrentBatteryLevel</span>()</span></span><br><span class="line">    &#123;</span><br><span class="line">    <span class="meta">#<span class="keyword">if</span> ANDROID</span></span><br><span class="line">        <span class="keyword">var</span> bm = Android.App.Application.Context.GetSystemService(Android.Content.Context.BatteryService) <span class="keyword">as</span> Android.OS.BatteryManager;</span><br><span class="line">        <span class="keyword">return</span> bm?.GetIntProperty((<span class="built_in">int</span>)Android.OS.BatteryProperty.Capacity) ?? <span class="number">-1</span>;</span><br><span class="line">    <span class="meta">#<span class="keyword">elif</span> IOS</span></span><br><span class="line">        UIKit.UIDevice.CurrentDevice.BatteryMonitoringEnabled = <span class="literal">true</span>;</span><br><span class="line">        <span class="keyword">return</span> (<span class="built_in">int</span>)(UIKit.UIDevice.CurrentDevice.BatteryLevel * <span class="number">100</span>);</span><br><span class="line">    <span class="meta">#<span class="keyword">elif</span> WINDOWS</span></span><br><span class="line">        <span class="comment">// ... Windows specific code ...</span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">// Placeholder</span></span><br><span class="line">    <span class="meta">#<span class="keyword">else</span></span></span><br><span class="line">        <span class="keyword">return</span> <span class="number">-1</span>; <span class="comment">// Other platforms</span></span><br><span class="line">    <span class="meta">#<span class="keyword">endif</span></span></span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">StartListening</span>()</span> &#123; <span class="comment">/* ... Platform specific ... */</span> &#125;</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">void</span> <span class="title">StopListening</span>()</span> &#123; <span class="comment">/* ... Platform specific ... */</span> &#125;</span><br><span class="line"></span><br><span class="line">    <span class="function"><span class="keyword">protected</span> <span class="keyword">void</span> <span class="title">OnBatteryLevelChanged</span>(<span class="params"><span class="built_in">int</span> level</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        BatteryLevelChanged?.Invoke(<span class="keyword">this</span>, level);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>注册服务 (<code>MauiProgram.cs</code>):</strong></p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">builder.Services.AddSingleton&lt;IBatteryNotifier, BatteryNotifier&gt;();</span><br><span class="line"><span class="comment">// or</span></span><br><span class="line"><span class="comment">// builder.Services.AddSingleton&lt;IBatteryNotifier, BatteryNotifierWithConditionalCompilation&gt;();</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>从 Blazor 组件调用原生功能 (与之前示例类似):</strong><br>注入 <code>IBatteryNotifier</code> 并使用其方法和事件。</p>
</li>
</ol>
<h2 id="8-JavaScript-互操作-JS-Interop"><a href="#8-JavaScript-互操作-JS-Interop" class="headerlink" title="8. JavaScript 互操作 (JS Interop)"></a>8. JavaScript 互操作 (JS Interop)</h2><p>尽管 Blazor Hybrid 强调直接 .NET 访问原生功能，但有时仍需要与 <code>BlazorWebView</code> 内的 JavaScript 交互（例如，使用现有的 JS 库或执行某些 Web API）。JS Interop 的工作方式与 Blazor WebAssembly 或 Blazor Server 非常相似。</p>
<h3 id="从-NET-调用-JavaScript"><a href="#从-NET-调用-JavaScript" class="headerlink" title="从 .NET 调用 JavaScript"></a>从 .NET 调用 JavaScript</h3><p>注入 <code>IJSRuntime</code> 服务。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">@inject IJSRuntime JSRuntime</span><br><span class="line"></span><br><span class="line">&lt;button @onclick=&quot;CallJavaScript&quot;&gt;Call JS&lt;/button&gt;</span><br><span class="line"></span><br><span class="line">@code &#123;</span><br><span class="line">    private async Task CallJavaScript()</span><br><span class="line">    &#123;</span><br><span class="line">        await JSRuntime.InvokeVoidAsync(&quot;myJsFunctions.showAlert&quot;, &quot;Hello from .NET MAUI Blazor!&quot;);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>在 <code>wwwroot/index.html</code> 或引用的 JS 文件中定义 <code>myJsFunctions.showAlert</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">script</span>&gt;</span><span class="language-javascript"></span></span><br><span class="line"><span class="language-javascript">  <span class="variable language_">window</span>.<span class="property">myJsFunctions</span> = &#123;</span></span><br><span class="line"><span class="language-javascript">    <span class="attr">showAlert</span>: <span class="keyword">function</span> (<span class="params">message</span>) &#123;</span></span><br><span class="line"><span class="language-javascript">      <span class="title function_">alert</span>(message);</span></span><br><span class="line"><span class="language-javascript">    &#125;,</span></span><br><span class="line"><span class="language-javascript">  &#125;;</span></span><br><span class="line"><span class="language-javascript"></span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="从-JavaScript-调用-NET"><a href="#从-JavaScript-调用-NET" class="headerlink" title="从 JavaScript 调用 .NET"></a>从 JavaScript 调用 .NET</h3><p>.NET 方法必须是静态的或实例方法（通过 <code>DotNetObjectReference</code>），并用 <code>[JSInvokable]</code> 标记。</p>
<figure class="highlight csharp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// MyCSharpStaticMethods.cs (in your shared Blazor component library)</span></span><br><span class="line"><span class="keyword">using</span> Microsoft.JSInterop;</span><br><span class="line"></span><br><span class="line"><span class="keyword">public</span> <span class="keyword">static</span> <span class="keyword">class</span> <span class="title">MyCSharpStaticMethods</span></span><br><span class="line">&#123;</span><br><span class="line">    [<span class="meta">JSInvokable</span>]</span><br><span class="line">    <span class="function"><span class="keyword">public</span> <span class="keyword">static</span> <span class="built_in">string</span> <span class="title">GetGreeting</span>(<span class="params"><span class="built_in">string</span> name</span>)</span></span><br><span class="line">    &#123;</span><br><span class="line">        <span class="keyword">return</span> <span class="string">$&quot;Hello, <span class="subst">&#123;name&#125;</span> from C#!&quot;</span>;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// In your JS file or &lt;script&gt; tag</span></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">function</span> <span class="title function_">callDotNet</span>(<span class="params"></span>) &#123;</span><br><span class="line">  <span class="keyword">const</span> result = <span class="keyword">await</span> <span class="title class_">DotNet</span>.<span class="title function_">invokeMethodAsync</span>(</span><br><span class="line">    <span class="string">&quot;MyMauiBlazorApp&quot;</span>,</span><br><span class="line">    <span class="string">&quot;GetGreeting&quot;</span>,</span><br><span class="line">    <span class="string">&quot;JavaScript&quot;</span></span><br><span class="line">  );</span><br><span class="line">  <span class="comment">// Note: &#x27;MyMauiBlazorApp&#x27; is the assembly name of your .NET MAUI project</span></span><br><span class="line">  <span class="comment">// or the RCL containing MyCSharpStaticMethods.</span></span><br><span class="line">  <span class="variable language_">console</span>.<span class="title function_">log</span>(result); <span class="comment">// Outputs: &quot;Hello, JavaScript from C#!&quot;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="9-样式化应用"><a href="#9-样式化应用" class="headerlink" title="9. 样式化应用"></a>9. 样式化应用</h2><h3 id="全局样式-wwwroot-css"><a href="#全局样式-wwwroot-css" class="headerlink" title="全局样式 (wwwroot/css)"></a>全局样式 (<code>wwwroot/css</code>)</h3><p>在 <code>wwwroot/css/app.css</code> (或你选择的其他 CSS 文件) 中定义全局样式。这些样式会像在标准 Web 应用中一样应用于 Blazor 组件。你也可以链接 Bootstrap 等 CSS 框架。</p>
<h3 id="组件作用域-CSS-razor-css"><a href="#组件作用域-CSS-razor-css" class="headerlink" title="组件作用域 CSS (.razor.css)"></a>组件作用域 CSS (<code>.razor.css</code>)</h3><p>Blazor 的 CSS 隔离功能在 Hybrid 应用中同样有效。为组件创建 <code>.razor.css</code> 文件，其中的样式将仅应用于该组件。构建过程会将这些作用域样式捆绑到 <code>YourProjectName.styles.css</code> 中，并在 <code>wwwroot/index.html</code> 中引用。</p>
<h3 id="混合原生-UI-元素-高级"><a href="#混合原生-UI-元素-高级" class="headerlink" title="混合原生 UI 元素 (高级)"></a>混合原生 UI 元素 (高级)</h3><p>虽然 .NET MAUI Blazor 的主要 UI 在 <code>BlazorWebView</code> 中，但你仍然可以在 <code>BlazorWebView</code> 之外使用 .NET MAUI 的原生 UI 控件。例如，你可以拥有一个包含原生顶部导航栏的 .NET MAUI 页面，该导航栏下方是一个占据剩余空间的 <code>BlazorWebView</code>。这需要更深入地了解 .NET MAUI 页面布局和导航。</p>
<h2 id="10-代码共享策略"><a href="#10-代码共享策略" class="headerlink" title="10. 代码共享策略"></a>10. 代码共享策略</h2><h3 id="与-Blazor-Web-应用共享-Razor-类库-RCL"><a href="#与-Blazor-Web-应用共享-Razor-类库-RCL" class="headerlink" title="与 Blazor Web 应用共享 Razor 类库 (RCL)"></a>与 Blazor Web 应用共享 Razor 类库 (RCL)</h3><p>这是实现最大代码重用的关键。</p>
<ol>
<li>创建一个新的 “Razor Class Library” (RCL) 项目。</li>
<li>将共享的 Blazor 组件 (<code>.razor</code> 文件)、布局、样式 (<code>wwwroot</code> 文件夹在 RCL 中) 和 C# 逻辑移到这个 RCL 中。</li>
<li>让你的 .NET MAUI Blazor 应用和你的 Blazor Web 应用 (Server 或 WASM) 都引用这个 RCL 项目。</li>
<li>在 .NET MAUI Blazor 应用中，静态资源（如 RCL 中的 CSS）需要正确配置才能被 <code>BlazorWebView</code> 找到。通常，构建过程会处理好这个问题，但确保 <code>wwwroot/index.html</code> 正确引用了聚合的样式表（如 <code>MyRcl.styles.css</code>）。</li>
</ol>
<h3 id="共享业务逻辑"><a href="#共享业务逻辑" class="headerlink" title="共享业务逻辑"></a>共享业务逻辑</h3><p>纯 C# 业务逻辑（服务、模型、帮助类）可以放在标准的 .NET 类库项目中，然后被 .NET MAUI Blazor 应用和任何其他 .NET 应用（包括 Web API、Blazor Web 应用等）引用。</p>
<h2 id="11-调试-NET-MAUI-Blazor-应用"><a href="#11-调试-NET-MAUI-Blazor-应用" class="headerlink" title="11. 调试 .NET MAUI Blazor 应用"></a>11. 调试 .NET MAUI Blazor 应用</h2><ul>
<li><strong>C# 代码</strong>: 可以像调试任何 .NET MAUI 或 Blazor 应用一样，在 Visual Studio 中设置断点并进行调试。</li>
<li><strong>Web 内容 (HTML, CSS, JS)</strong>:<ul>
<li>在 Windows 上，如果启用了开发者工具 (<code>AddBlazorWebViewDeveloperTools()</code>)，通常可以在 <code>BlazorWebView</code> 上右键单击并选择 “Inspect” 或 “Inspect Element” (取决于 WebView2 的行为) 来打开浏览器开发工具。</li>
<li>在 macOS 上，需要启用 Safari 的开发者菜单 (<code>Safari &gt; Preferences &gt; Advanced &gt; Show Develop menu in menu bar</code>)，然后在运行的应用中的 <code>BlazorWebView</code> 上下文菜单中选择 “Inspect Element”。</li>
<li>Android 和 iOS 调试 Web 内容可能需要特定平台的工具和配置（例如，Android Studio 的 Layout Inspector 或 Chrome DevTools for Android WebViews，Safari Web Inspector for iOS WebViews）。</li>
</ul>
</li>
</ul>
<h2 id="12-部署"><a href="#12-部署" class="headerlink" title="12. 部署"></a>12. 部署</h2><p>.NET MAUI Blazor 应用的部署遵循标准的 .NET MAUI 部署流程：</p>
<ul>
<li><strong>Android</strong>: 创建签名的 APK 或 AAB 包，然后分发到 Google Play Store 或侧载。</li>
<li><strong>iOS</strong>: 需要 Apple 开发者账户，通过 Xcode 或 Visual Studio for Mac (或 Windows 上的配对连接) 归档和分发到 App Store 或进行 Ad Hoc&#x2F;企业分发。</li>
<li><strong>macOS</strong>: 可以创建 <code>.app</code> 包或 <code>.pkg</code> 安装程序，并通过 Mac App Store 或直接分发。</li>
<li><strong>Windows</strong>: 可以使用 MSIX 打包，分发到 Microsoft Store 或直接部署。</li>
</ul>
<h2 id="13-NET-MAUI-Blazor-Hybrid-适用场景"><a href="#13-NET-MAUI-Blazor-Hybrid-适用场景" class="headerlink" title="13. .NET MAUI Blazor Hybrid 适用场景"></a>13. .NET MAUI Blazor Hybrid 适用场景</h2><ul>
<li><strong>Web 开发者希望构建原生应用</strong>: 如果你已经熟悉 Blazor 和 Web 技术，这是进入原生移动和桌面开发的一条平滑路径。</li>
<li><strong>代码重用是关键</strong>: 当你需要为 Web、桌面和移动平台提供类似的用户体验和功能时。</li>
<li><strong>应用需要丰富的 Web UI，同时结合原生功能</strong>: 当标准 Web 应用无法满足对设备功能的访问需求时。</li>
<li><strong>现有 Blazor Web 应用的扩展</strong>: 将现有的 Blazor Web 应用打包成本地应用，并增强其原生功能。</li>
<li><strong>原型设计和快速开发</strong>: 利用 Web 技术的快速迭代优势来构建跨平台应用。</li>
</ul>
<h2 id="14-局限性与考量"><a href="#14-局限性与考量" class="headerlink" title="14. 局限性与考量"></a>14. 局限性与考量</h2><ul>
<li><strong>原生观感</strong>: UI 是通过 Web 技术渲染的，可能无法 100% 达到特定平台的原生观感，除非投入大量精力进行 CSS 定制以模仿原生控件。</li>
<li><strong>WebView 性能</strong>: 虽然现代 Web View 控件性能优越，但在非常复杂或性能要求极高的场景下，其性能可能不如纯原生 UI。在低端设备上尤其需要注意。</li>
<li><strong>应用包大小</strong>: 应用包中需要包含 Web 资源 (HTML, CSS, JS) 和 <code>BlazorWebView</code> 的相关依赖，这可能会比纯原生 .NET MAUI 应用略大。</li>
<li><strong>平台差异</strong>: 尽管 .NET MAUI 和 Blazor 努力提供跨平台一致性，但在访问某些非常底层的原生功能或处理特定平台的 UI 怪癖时，仍可能需要编写平台特定的代码。</li>
<li><strong>启动时间</strong>: 第一次加载 <code>BlazorWebView</code> 并初始化 Blazor 应用可能比纯原生页面略慢，尽管后续导航通常很快。</li>
</ul>
<h2 id="15-总结"><a href="#15-总结" class="headerlink" title="15. 总结"></a>15. 总结</h2><p>.NET MAUI Blazor Hybrid 提供了一种强大而灵活的方式，让 Web 开发者能够利用他们现有的 Blazor 技能和代码库来构建功能齐全、可以访问原生设备功能的多平台桌面和移动应用程序。通过将 Blazor 的 Web UI 能力与 .NET MAUI 的原生平台访问能力相结合，开发者可以高效地创建丰富的用户体验，同时最大限度地实现代码共享。</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Jackey Zhou</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/05/12/blazor-maui%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/05/12/blazor-maui%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/')">blazor maui基础知识</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/05/12/blazor-maui%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=blazor maui基础知识&amp;url=http://example.com/2025/05/12/blazor-maui%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Welcome To LifeTech's Blog</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/csharp%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>csharp相关学习<span class="tagsPageCount">5</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/05/12/blazor%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">blazor基础知识</div></div></a></div><div class="next-post pull-right"><a href="/2025/05/12/blazor-winforms%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">blazor winforms基础知识</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/05/12/ASP-NET-WEB-API/" title="ASP.NET WEB API"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-12</div><div class="title">ASP.NET WEB API</div></div></a></div><div><a href="/2025/05/12/blazor-winforms%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="blazor winforms基础知识"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-12</div><div class="title">blazor winforms基础知识</div></div></a></div><div><a href="/2025/05/12/blazor%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="blazor基础知识"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-12</div><div class="title">blazor基础知识</div></div></a></div><div><a href="/2025/05/12/csharp%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="csharp基础知识"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-12</div><div class="title">csharp基础知识</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">记录技术成长的个人博客</div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%AE%80%E4%BB%8B"><span class="toc-number">1.</span> <span class="toc-text">1. 简介</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-NET-MAUI"><span class="toc-number">1.1.</span> <span class="toc-text">什么是 .NET MAUI?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF-Blazor-Hybrid"><span class="toc-number">1.2.</span> <span class="toc-text">什么是 Blazor Hybrid?</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NET-MAUI-Blazor-Hybrid-%E7%9A%84%E6%A0%B8%E5%BF%83%E6%80%9D%E6%83%B3"><span class="toc-number">1.3.</span> <span class="toc-text">.NET MAUI Blazor Hybrid 的核心思想</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-%E4%B8%BA%E4%BD%95%E9%80%89%E6%8B%A9-NET-MAUI-Blazor-Hybrid-%E4%BC%98%E5%8A%BF"><span class="toc-number">2.</span> <span class="toc-text">2. 为何选择 .NET MAUI Blazor Hybrid? (优势)</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-%E6%90%AD%E5%BB%BA%E5%BC%80%E5%8F%91%E7%8E%AF%E5%A2%83"><span class="toc-number">3.</span> <span class="toc-text">3. 搭建开发环境</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-%E5%88%9B%E5%BB%BA%E7%AC%AC%E4%B8%80%E4%B8%AA-NET-MAUI-Blazor-%E5%BA%94%E7%94%A8"><span class="toc-number">4.</span> <span class="toc-text">4. 创建第一个 .NET MAUI Blazor 应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-Visual-Studio"><span class="toc-number">4.1.</span> <span class="toc-text">使用 Visual Studio</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8-NET-CLI"><span class="toc-number">4.2.</span> <span class="toc-text">使用 .NET CLI</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84%E8%A7%A3%E6%9E%90"><span class="toc-number">4.3.</span> <span class="toc-text">项目结构解析</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-%E6%A0%B8%E5%BF%83%E7%BB%84%E4%BB%B6-BlazorWebView"><span class="toc-number">5.</span> <span class="toc-text">5. 核心组件: BlazorWebView</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#HostPage-%E5%B1%9E%E6%80%A7"><span class="toc-number">5.1.</span> <span class="toc-text">HostPage 属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#RootComponents-%E9%9B%86%E5%90%88"><span class="toc-number">5.2.</span> <span class="toc-text">RootComponents 集合</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%9C%8D%E5%8A%A1%E9%85%8D%E7%BD%AE-MauiProgram-cs"><span class="toc-number">5.3.</span> <span class="toc-text">服务配置 (MauiProgram.cs)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-%E4%BD%BF%E7%94%A8-Blazor-%E6%9E%84%E5%BB%BA%E7%94%A8%E6%88%B7%E7%95%8C%E9%9D%A2"><span class="toc-number">6.</span> <span class="toc-text">6. 使用 Blazor 构建用户界面</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Razor-%E7%BB%84%E4%BB%B6-razor"><span class="toc-number">6.1.</span> <span class="toc-text">Razor 组件 (.razor)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%83%E5%B1%80-Layouts"><span class="toc-number">6.2.</span> <span class="toc-text">布局 (Layouts)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1-Routing"><span class="toc-number">6.3.</span> <span class="toc-text">路由 (Routing)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%BB%91%E5%AE%9A%E4%B8%8E%E4%BA%8B%E4%BB%B6%E5%A4%84%E7%90%86"><span class="toc-number">6.4.</span> <span class="toc-text">数据绑定与事件处理</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BE%9D%E8%B5%96%E6%B3%A8%E5%85%A5-DI"><span class="toc-number">6.5.</span> <span class="toc-text">依赖注入 (DI)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#7-%E8%AE%BF%E9%97%AE%E6%9C%AC%E6%9C%BA%E8%AE%BE%E5%A4%87%E5%8A%9F%E8%83%BD-Native-Device-Features"><span class="toc-number">7.</span> <span class="toc-text">7. 访问本机设备功能 (Native Device Features)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%80%9A%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%9A%E6%8A%BD%E8%B1%A1%E4%B8%8E%E6%9C%8D%E5%8A%A1%E6%B3%A8%E5%85%A5"><span class="toc-number">7.1.</span> <span class="toc-text">通用方法：抽象与服务注入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#NET-MAUI-Essentials"><span class="toc-number">7.2.</span> <span class="toc-text">.NET MAUI Essentials</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-1-%E8%8E%B7%E5%8F%96%E8%AE%BE%E5%A4%87%E4%BF%A1%E6%81%AF"><span class="toc-number">7.3.</span> <span class="toc-text">示例 1: 获取设备信息</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-2-%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE"><span class="toc-number">7.4.</span> <span class="toc-text">示例 2: 地理位置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%A4%BA%E4%BE%8B-3-%E8%B0%83%E7%94%A8%E5%B9%B3%E5%8F%B0%E7%89%B9%E5%AE%9A-API-%E9%83%A8%E5%88%86%E7%B1%BB%E4%B8%8E%E6%9D%A1%E4%BB%B6%E7%BC%96%E8%AF%91"><span class="toc-number">7.5.</span> <span class="toc-text">示例 3: 调用平台特定 API (部分类与条件编译)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#8-JavaScript-%E4%BA%92%E6%93%8D%E4%BD%9C-JS-Interop"><span class="toc-number">8.</span> <span class="toc-text">8. JavaScript 互操作 (JS Interop)</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E-NET-%E8%B0%83%E7%94%A8-JavaScript"><span class="toc-number">8.1.</span> <span class="toc-text">从 .NET 调用 JavaScript</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%8E-JavaScript-%E8%B0%83%E7%94%A8-NET"><span class="toc-number">8.2.</span> <span class="toc-text">从 JavaScript 调用 .NET</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#9-%E6%A0%B7%E5%BC%8F%E5%8C%96%E5%BA%94%E7%94%A8"><span class="toc-number">9.</span> <span class="toc-text">9. 样式化应用</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%A8%E5%B1%80%E6%A0%B7%E5%BC%8F-wwwroot-css"><span class="toc-number">9.1.</span> <span class="toc-text">全局样式 (wwwroot&#x2F;css)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%84%E4%BB%B6%E4%BD%9C%E7%94%A8%E5%9F%9F-CSS-razor-css"><span class="toc-number">9.2.</span> <span class="toc-text">组件作用域 CSS (.razor.css)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%B7%B7%E5%90%88%E5%8E%9F%E7%94%9F-UI-%E5%85%83%E7%B4%A0-%E9%AB%98%E7%BA%A7"><span class="toc-number">9.3.</span> <span class="toc-text">混合原生 UI 元素 (高级)</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#10-%E4%BB%A3%E7%A0%81%E5%85%B1%E4%BA%AB%E7%AD%96%E7%95%A5"><span class="toc-number">10.</span> <span class="toc-text">10. 代码共享策略</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%8E-Blazor-Web-%E5%BA%94%E7%94%A8%E5%85%B1%E4%BA%AB-Razor-%E7%B1%BB%E5%BA%93-RCL"><span class="toc-number">10.1.</span> <span class="toc-text">与 Blazor Web 应用共享 Razor 类库 (RCL)</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B1%E4%BA%AB%E4%B8%9A%E5%8A%A1%E9%80%BB%E8%BE%91"><span class="toc-number">10.2.</span> <span class="toc-text">共享业务逻辑</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#11-%E8%B0%83%E8%AF%95-NET-MAUI-Blazor-%E5%BA%94%E7%94%A8"><span class="toc-number">11.</span> <span class="toc-text">11. 调试 .NET MAUI Blazor 应用</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#12-%E9%83%A8%E7%BD%B2"><span class="toc-number">12.</span> <span class="toc-text">12. 部署</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#13-NET-MAUI-Blazor-Hybrid-%E9%80%82%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">13.</span> <span class="toc-text">13. .NET MAUI Blazor Hybrid 适用场景</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#14-%E5%B1%80%E9%99%90%E6%80%A7%E4%B8%8E%E8%80%83%E9%87%8F"><span class="toc-number">14.</span> <span class="toc-text">14. 局限性与考量</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#15-%E6%80%BB%E7%BB%93"><span class="toc-number">15.</span> <span class="toc-text">15. 总结</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/15/tauri%E5%89%8D%E5%90%8E%E7%AB%AF%E4%BA%A4%E4%BA%92/" title="tauri前后端交互">tauri前后端交互</a><time datetime="2025-05-14T16:28:49.000Z" title="发表于 2025-05-15 00:28:49">2025-05-15</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/12/vue3%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="vue3基础知识">vue3基础知识</a><time datetime="2025-05-12T15:28:53.000Z" title="发表于 2025-05-12 23:28:53">2025-05-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/12/%E6%A8%A1%E5%9E%8B%E9%83%A8%E7%BD%B2/" title="模型部署">模型部署</a><time datetime="2025-05-11T18:17:36.000Z" title="发表于 2025-05-12 02:17:36">2025-05-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/12/%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" title="数据科学与机器学习">数据科学与机器学习</a><time datetime="2025-05-11T18:17:28.000Z" title="发表于 2025-05-12 02:17:28">2025-05-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/12/pytorch%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="pytorch基础知识">pytorch基础知识</a><time datetime="2025-05-11T18:17:15.000Z" title="发表于 2025-05-12 02:17:15">2025-05-12</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="Jackey Zhou" target="_blank">Jackey Zhou</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">52</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">16</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">0</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CSharp%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">CSharp学习<sup>3</sup></a><a href="/tags/IDE%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 0.88rem;">IDE常用快捷键<sup>2</sup></a><a href="/tags/Rust%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 0.88rem;">Rust基础知识<sup>21</sup></a><a href="/tags/csharp%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">csharp相关学习<sup>5</sup></a><a href="/tags/docker%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">docker学习<sup>1</sup></a><a href="/tags/hexo%E5%8D%9A%E5%AE%A2%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4/" style="font-size: 0.88rem;">hexo博客常见命令<sup>1</sup></a><a href="/tags/python%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">python相关学习<sup>4</sup></a><a href="/tags/tauri%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 0.88rem;">tauri基础知识<sup>1</sup></a><a href="/tags/xmake%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">xmake学习<sup>3</sup></a><a href="/tags/%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">个人学习<sup>1</sup></a><a href="/tags/%E5%89%8D%E7%AB%AF%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">前端学习<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" style="font-size: 0.88rem;">数据分析<sup>1</sup></a><a href="/tags/%E6%97%A0%E7%BA%BF%E8%B0%83%E8%AF%95/" style="font-size: 0.88rem;">无线调试<sup>1</sup></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">深度学习<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" style="font-size: 0.88rem;">系统常用命令<sup>2</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 0.88rem;">系统常用快捷键<sup>2</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Jackey Zhou 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>