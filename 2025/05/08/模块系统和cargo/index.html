<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no"><title>模块系统和cargo | Welcome To LifeTech's Blog</title><meta name="keywords" content="Rust基础知识"><meta name="author" content="Jackey Zhou"><meta name="copyright" content="Jackey Zhou"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#f7f9fe"><meta name="mobile-web-app-capable" content="yes"><meta name="apple-touch-fullscreen" content="yes"><meta name="apple-mobile-web-app-title" content="模块系统和cargo"><meta name="application-name" content="模块系统和cargo"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="#f7f9fe"><meta property="og:type" content="article"><meta property="og:title" content="模块系统和cargo"><meta property="og:url" content="http://example.com/2025/05/08/%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%92%8Ccargo/index.html"><meta property="og:site_name" content="Welcome To LifeTech's Blog"><meta property="og:description" content="模块系统 (Module System) 和 Cargo 是 Rust 开发中用于组织代码、管理项目和处理依赖的核心工具。理解它们对于编写任何规模的 Rust 程序都至关重要。 模块系统 (The Module System)Rust 的模块系统用于将代码组织成逻辑单元，控制代码的可见性（封装），并"><meta property="og:locale" content="zh-CN"><meta property="og:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta property="article:author" content="Jackey Zhou"><meta property="article:tag"><meta name="twitter:card" content="summary"><meta name="twitter:image" content="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg"><meta name="description" content="模块系统 (Module System) 和 Cargo 是 Rust 开发中用于组织代码、管理项目和处理依赖的核心工具。理解它们对于编写任何规模的 Rust 程序都至关重要。 模块系统 (The Module System)Rust 的模块系统用于将代码组织成逻辑单元，控制代码的可见性（封装），并"><link rel="shortcut icon" href="/favicon.ico"><link rel="canonical" href="http://example.com/2025/05/08/%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%92%8Ccargo/"><link rel="preconnect" href="//cdn.cbd.int"/><meta name="google-site-verification" content="xxx"/><meta name="baidu-site-verification" content="code-xxx"/><meta name="msvalidate.01" content="xxx"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.css" media="print" onload="this.media='all'"><link rel="stylesheet" href="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = {
  linkPageTop: undefined,
  peoplecanvas: {"enable":true,"img":"https://upload-bbs.miyoushe.com/upload/2024/07/27/125766904/ba62475f396df9de3316a08ed9e65d86_5680958632268053399..png"},
  postHeadAiDescription: {"enable":true,"gptName":"AnZhiYu","mode":"local","switchBtn":false,"btnLink":"https://afdian.net/item/886a79d4db6711eda42a52540025c377","randomNum":3,"basicWordCount":1000,"key":"xxxx","Referer":"https://xx.xx/"},
  diytitle: {"enable":true,"leaveTitle":"w(ﾟДﾟ)w 不要走！再看看嘛！","backTitle":"♪(^∇^*)欢迎肥来！"},
  LA51: undefined,
  greetingBox: undefined,
  twikooEnvId: '',
  commentBarrageConfig:undefined,
  music_page_default: "nav_music",
  root: '/',
  preloader: {"source":3},
  friends_vue_info: undefined,
  navMusic: true,
  mainTone: undefined,
  authorStatus: undefined,
  algolia: undefined,
  localSearch: undefined,
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"简","rightMenuMsgToTraditionalChinese":"转为繁体","rightMenuMsgToSimplifiedChinese":"转为简体"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":330},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    simplehomepage: true,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: {"copy":true,"copyrightEbable":false,"limitCount":50,"languages":{"author":"作者: Jackey Zhou","link":"链接: ","source":"来源: Welcome To LifeTech's Blog","info":"著作权归作者所有。商业转载请联系作者获得授权，非商业转载请注明出处。","copySuccess":"复制成功，复制和转载请标注本文地址"}},
  lightbox: 'fancybox',
  Snackbar: {"chs_to_cht":"你已切换为繁体","cht_to_chs":"你已切换为简体","day_to_night":"你已切换为深色模式","night_to_day":"你已切换为浅色模式","bgLight":"#425AEF","bgDark":"#1f1f1f","position":"top-center"},
  source: {
    justifiedGallery: {
      js: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.min.js',
      css: 'https://cdn.cbd.int/flickr-justified-gallery@2.1.2/dist/fjGallery.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isAnchor: false,
  shortcutKey: undefined,
  autoDarkmode: true
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  configTitle: 'Welcome To LifeTech's Blog',
  title: '模块系统和cargo',
  postAI: '',
  pageFillDescription: '模块系统 (The Module System), 1. 核心概念, 2. 定义模块, 3. 路径 (Paths), 4. use 关键字, 5. 可见性 (pub), Cargo, 1. Cargo 的核心功能, 2. Cargo.toml (清单文件), 3. 主要 Cargo 命令, 4. 项目结构, 5. 依赖管理和 Cargo.lock, 6. 工作空间 (Workspaces), 7. 构建脚本 (build.rs)模块系统和是开发中用于组织代码管理项目和处理依赖的核心工具理解它们对于编写任何规模的程序都至关重要模块系统的模块系统用于将代码组织成逻辑单元控制代码的可见性封装并创建清晰的命名空间核心概念包一个包包含一个或多个稍后解释以及一个清单文件该文件描述了如何构建这些一个包最多只能包含一个库一个包可以包含任意数量的二进制但至少必须包含一个库或二进制单元包是编译器一次处理的最小编译单元代码首先被组织成库不会自行生成可执行文件而是提供可供其他程序使用的功能例如通过导入其根文件通常是二进制会生成一个可执行程序其根文件通常是如果一个包有和那么它有两个一个库和一个二进制文件它们的名字与包名相同你也可以在目录下放置多个文件每个文件都会被编译成一个独立的二进制模块在内部你可以使用模块来进一步组织代码控制作用域和路径的私有性模块可以嵌套模块帮助将相关的定义如函数结构体枚举常量等组合在一起并形成一个层次结构定义模块使用关键字来定义模块或定义一个名为的模块模块内容默认是私有的定义一个嵌套的公开的模块公开的函数可以调用同一模块内的私有函数私有的函数只能在模块内部访问使用模块中的项绝对路径从根开始相对路径从当前模块开始这里当前模块是根如果这是将模块移到其他文件当模块变大时你可能希望将其内容移到单独的文件中以保持或的整洁方法单个文件模块如果模块在文件中在或中会查找文件可以重新导出方便外部使用如果被了然后在文件中定义模块内容其他的内容方法目录模块旧式但仍支持如果模块及其子模块在目录下并且模块根是在或中会查找或中会查找或中现代更倾向于使用的方式即使模块有子模块子模块可以在内部定义或者子模块自身也可以是单独的文件路径路径用于命名模块中的项函数结构体模块等绝对路径从的根开始使用名或者字面量相对路径从当前模块开始使用或当前模块中的标识符指代当前模块本身指代当前模块的父模块相对路径或者相对路径通过访问兄弟模块关键字关键字可以将路径或路径的一部分引入当前的本地作用域从而避免重复写出冗长的路径不使用使用或者更习惯的做法是引入到父模块然后通过父模块访问直接使用如果上面是的习惯用法对于函数通常引入到其父模块然后通过模块名调用函数以表明函数不是在本地定义的例如对于结构体枚举和其他项通常直接引入完整路径例如然后直接使用如果存在名称冲突可以使用关键字为引入的类型指定新的本地名称可以将一个项引入作用域并使其在当前模块的公共中也可用重新导出将重新导出到模块的公共可以直接通过访问嵌套路径和引入和等同于运算符会将中的所有公共项引入当前作用域通常不推荐在库代码中使用因为它会使作用域中的名称来源变得不明确但在测试或特定应用场景中可能有用可见性默认情况下模块中的所有项函数方法结构体枚举模块常量都是私有的这意味着它们只能在其定义的模块及其子模块中被访问使用关键字可以使项公开从而允许外部代码访问它公开函数公开结构体如果结构体是其字段默认仍然是私有的你需要为希望公开的字段也标记这个字段是公开的这个字段是私有的公开的关联函数构造函数可以访问公开字段错误是私有的公开枚举如果枚举是它的所有变体也都是公开的更细粒度的可见性项在当前内的任何地方都可见但在外部是私有的项在其父模块中可见项在指定的模块及其子模块中可见是的官方构建系统和包管理器它负责处理许多常见的开发任务的核心功能项目管理创建新项目组织项目结构构建代码将代码编译成可执行文件或库依赖管理从的官方包注册中心下载并编译项目依赖的外部库测试运行单元测试集成测试和文档测试运行项目构建并执行二进制项目文档生成为项目及其依赖生成文档发布包将库发布到清单文件每个包的根目录下都有一个文件这是的清单文件使用格式它包含了项目的元数据和配置信息一个典型的文件包含以下部分包也是生成的库或二进制文件的默认名称的名称包的版本号遵循语义化版本作者列表要使用的版本例如等可选元数据列出项目运行时所需的依赖项从获取的版本或兼容版本可以指定版本号仓库路径本地路径等指定特性列出仅在测试示例或基准测试期间需要的依赖项这些不会被编译到最终的发布构建中和如果需要可以更详细地配置库或二进制文件的目标例如指定库的名称或二进制文件的路径构建配置允许你为不同的构建配置文件如用于开发用于发布定制编译器设置默认优化级别较低编译速度快包含调试信息使用优化级别高执行速度快编译时间长调试信息较少优化级别是否包含调试符号启用链接时优化减少并行编译单元数以获得更好的优化但编译更慢稍后介绍主要命令在你的项目目录下你可以从终端运行以下常用的命令创建一个新的二进制项目带创建一个新的库项目带编译当前包及其依赖项默认是开发模式可执行文件或库会放在目录下使用发布模式编译进行更多优化输出在目录下编译并运行二进制包如果是库包此命令无效快速检查代码以确保它可以编译但不产生任何可执行文件比快得多适合在编码时频繁检查运行项目中的所有测试单元测试集成测试和文档测试为当前包及其所有公共依赖项构建文档构建文档并在你的浏览器中打开清理构建目录删除所有编译产物根据中的版本要求更新文件和依赖项从下载并编译指定的通常是二进制工具并将其安装到你的用户二进制目录通常是将你的库包发布到需要先登录自动将依赖项添加到的部分例如可以指定版本和特性自动从中移除依赖项项目结构期望项目遵循一定的目录结构清单文件在项目根目录自动生成用于锁定依赖项的确切版本应提交到版本控制源代码目录二进制的根文件和函数的入口点库的根文件如果有多个二进制文件每个文件放在目录下会将它们编译成单独的可执行文件集成测试文件放在这里每个文件会被编译成一个单独的测试项目的使用示例代码每个文件是一个独立的示例基准测试代码存放所有编译产物和中间文件的目录通常会将其添加到依赖管理和当你添加一个依赖项到并首次构建时会从或其他源下载该依赖项及其所有传递依赖项它会解析所有版本要求并选择一个满足所有条件的版本组合然后会将所有选定的依赖项及其确切版本记录在文件中此后除非你显式运行或修改中的版本约束否则会始终使用中指定的版本这确保了可复现的构建即你和你的团队成员在不同时间不同机器上构建项目时都会使用完全相同的依赖版本工作空间工作空间允许你将多个相关的包组织在一个共同的顶层结构下这对于大型项目或一组相互依赖的库非常有用在项目根目录创建一个文件其中包含一个部分列出工作空间的成员包顶层一个名为的包在目录下一个名为的包在目录下假设依赖推荐使用较新的依赖解析器每个成员包都有其自己的文件但它们会共享一个顶层的文件和一个输出目录在工作空间根目录运行或会构建或测试所有成员包你可以使用来指定单个包构建脚本如果你的包需要在编译之前执行一些自定义的构建步骤例如编译本地的代码生成代码或与操作系统进行交互你可以在包的根目录下创建一个文件会在编译你的包之前先编译并运行这个构建脚本模块系统和共同为开发者提供了一个强大一致且易于使用的环境来组织代码管理依赖和构建项目它们是生态系统成功的关键因素之一',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2025-05-08 02:00:27',
  postMainColor: '',
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
      win.saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
    
      win.getScript = (url, attr = {}) => new Promise((resolve, reject) => {
        const script = document.createElement('script')
        script.src = url
        script.async = true
        script.onerror = reject
        script.onload = script.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          script.onload = script.onreadystatechange = null
          resolve()
        }

        Object.keys(attr).forEach(key => {
          script.setAttribute(key, attr[key])
        })

        document.head.appendChild(script)
      })
    
      win.getCSS = (url, id = false) => new Promise((resolve, reject) => {
        const link = document.createElement('link')
        link.rel = 'stylesheet'
        link.href = url
        if (id) link.id = id
        link.onerror = reject
        link.onload = link.onreadystatechange = function() {
          const loadState = this.readyState
          if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
          link.onload = link.onreadystatechange = null
          resolve()
        }
        document.head.appendChild(link)
      })
    
      win.activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#18171d')
        }
      }
      win.activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#f7f9fe')
        }
      }
      const t = saveToLocal.get('theme')
    
          const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
          const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
          const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
          const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

          if (t === undefined) {
            if (isLightMode) activateLightMode()
            else if (isDarkMode) activateDarkMode()
            else if (isNotSpecified || hasNoSupport) {
              const now = new Date()
              const hour = now.getHours()
              const isNight = hour <= 6 || hour >= 18
              isNight ? activateDarkMode() : activateLightMode()
            }
            window.matchMedia('(prefers-color-scheme: dark)').addListener(e => {
              if (saveToLocal.get('theme') === undefined) {
                e.matches ? activateDarkMode() : activateLightMode()
              }
            })
          } else if (t === 'light') activateLightMode()
          else activateDarkMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })(window)</script><meta name="generator" content="Hexo 7.3.0"></head><body data-type="anzhiyu"><div id="web_bg"></div><div id="an_music_bg"></div><div id="loading-box" onclick="document.getElementById(&quot;loading-box&quot;).classList.add(&quot;loaded&quot;)"><div class="loading-bg"><img class="loading-img nolazyload" alt="加载头像" src="https://npm.elemecdn.com/anzhiyu-blog-static@1.0.4/img/avatar.jpg"/><div class="loading-image-dot"></div></div></div><script>const preloader = {
  endLoading: () => {
    document.getElementById('loading-box').classList.add("loaded");
  },
  initLoading: () => {
    document.getElementById('loading-box').classList.remove("loaded")
  }
}
window.addEventListener('load',()=> { preloader.endLoading() })
setTimeout(function(){preloader.endLoading();},10000)

if (true) {
  document.addEventListener('pjax:send', () => { preloader.initLoading() })
  document.addEventListener('pjax:complete', () => { preloader.endLoading() })
}</script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.10/progress_bar/progress_bar.css"/><script async="async" src="https://cdn.cbd.int/pace-js@1.2.4/pace.min.js" data-pace-options="{ &quot;restartOnRequestAfter&quot;:false,&quot;eventLag&quot;:false}"></script><div class="post" id="body-wrap"><header class="post-bg" id="page-header"><nav id="nav"><div id="nav-group"><span id="blog_name"><a id="site-name" href="/" accesskey="h"><div class="title">Welcome To LifeTech's Blog</div><i class="anzhiyufont anzhiyu-icon-house-chimney"></i></a></span><div class="mask-name-container"><div id="name-container"><a id="page-name" href="javascript:anzhiyu.scrollToDest(0, 500)">PAGE_NAME</a></div></div><div id="menus"></div><div id="nav-right"><div class="nav-button" id="randomPost_button"><a class="site-page" onclick="toRandomPost()" title="随机前往一个文章" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-dice"></i></a></div><input id="center-console" type="checkbox"/><label class="widget" for="center-console" title="中控台" onclick="anzhiyu.switchConsole();"><i class="left"></i><i class="widget center"></i><i class="widget right"></i></label><div id="console"><div class="console-card-group-reward"><ul class="reward-all console-card"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" alt="微信" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" alt="支付宝" src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div><div class="console-card-group"><div class="console-card-group-left"><div class="console-card" id="card-newest-comments"><div class="card-content"><div class="author-content-item-tips">互动</div><span class="author-content-item-title"> 最新评论</span></div><div class="aside-list"><span>正在加载中...</span></div></div></div><div class="console-card-group-right"><div class="console-card tags"><div class="card-content"><div class="author-content-item-tips">兴趣点</div><span class="author-content-item-title">寻找你感兴趣的领域</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CSharp%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">CSharp学习<sup>3</sup></a><a href="/tags/IDE%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 1.05rem;">IDE常用快捷键<sup>2</sup></a><a href="/tags/Rust%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 1.05rem;">Rust基础知识<sup>21</sup></a><a href="/tags/csharp%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">csharp相关学习<sup>5</sup></a><a href="/tags/docker%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">docker学习<sup>1</sup></a><a href="/tags/hexo%E5%8D%9A%E5%AE%A2%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4/" style="font-size: 1.05rem;">hexo博客常见命令<sup>1</sup></a><a href="/tags/python%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">python相关学习<sup>4</sup></a><a href="/tags/xmake%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">xmake学习<sup>3</sup></a><a href="/tags/%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">个人学习<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" style="font-size: 1.05rem;">数据分析<sup>1</sup></a><a href="/tags/%E6%97%A0%E7%BA%BF%E8%B0%83%E8%AF%95/" style="font-size: 1.05rem;">无线调试<sup>1</sup></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 1.05rem;">深度学习<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" style="font-size: 1.05rem;">系统常用命令<sup>2</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 1.05rem;">系统常用快捷键<sup>2</sup></a></div></div><hr/></div></div><div class="console-card history"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-box-archiv"></i><span>文章</span></div><div class="card-archives"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-archive"></i><span>归档</span></div><ul class="card-archive-list"><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2025/05/"><span class="card-archive-list-date">五月 2025</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">30</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/12/"><span class="card-archive-list-date">十二月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">3</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/11/"><span class="card-archive-list-date">十一月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">5</span><span>篇</span></div></a></li><li class="card-archive-list-item"><a class="card-archive-list-link" href="/archives/2024/10/"><span class="card-archive-list-date">十月 2024</span><div class="card-archive-list-count-group"><span class="card-archive-list-count">12</span><span>篇</span></div></a></li></ul></div><hr/></div></div></div><div class="button-group"><div class="console-btn-item"><a class="darkmode_switchbutton" title="显示模式切换" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-moon"></i></a></div><div class="console-btn-item" id="consoleHideAside" onclick="anzhiyu.hideAsideBtn()" title="边栏显示控制"><a class="asideSwitch"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></a></div><div class="console-btn-item" id="consoleMusic" onclick="anzhiyu.musicToggle()" title="音乐开关"><a class="music-switch"><i class="anzhiyufont anzhiyu-icon-music"></i></a></div></div><div class="console-mask" onclick="anzhiyu.hideConsole()" href="javascript:void(0);"></div></div><div class="nav-button" id="nav-totop"><a class="totopbtn" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i><span id="percent" onclick="anzhiyu.scrollToDest(0,500)">0</span></a></div><div id="toggle-menu"><a class="site-page" href="javascript:void(0);" title="切换"><i class="anzhiyufont anzhiyu-icon-bars"></i></a></div></div></div></nav><div id="post-info"><div id="post-firstinfo"><div class="meta-firstline"><a class="post-meta-original">原创</a><span class="article-meta tags"><a class="article-meta__tags" href="/tags/Rust%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" tabindex="-1" itemprop="url"> <span> <i class="anzhiyufont anzhiyu-icon-hashtag"></i>Rust基础知识</span></a></span></div></div><h1 class="post-title" itemprop="name headline">模块系统和cargo</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="anzhiyufont anzhiyu-icon-calendar-days post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" itemprop="dateCreated datePublished" datetime="2025-05-07T17:44:45.000Z" title="发表于 2025-05-08 01:44:45">2025-05-08</time><span class="post-meta-separator"></span><i class="anzhiyufont anzhiyu-icon-history post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" itemprop="dateCreated datePublished" datetime="2025-05-07T18:00:27.846Z" title="更新于 2025-05-08 02:00:27">2025-05-08</time></span></div><div class="meta-secondline"><span class="post-meta-separator">       </span><span class="post-meta-position" title="作者IP属地为无锡"><i class="anzhiyufont anzhiyu-icon-location-dot"></i>无锡</span></div></div></div><section class="main-hero-waves-area waves-area"><svg class="waves-svg" xmlns="http://www.w3.org/2000/svg" xlink="http://www.w3.org/1999/xlink" viewBox="0 24 150 28" preserveAspectRatio="none" shape-rendering="auto"><defs><path id="gentle-wave" d="M -160 44 c 30 0 58 -18 88 -18 s 58 18 88 18 s 58 -18 88 -18 s 58 18 88 18 v 44 h -352 Z"></path></defs><g class="parallax"><use href="#gentle-wave" x="48" y="0"></use><use href="#gentle-wave" x="48" y="3"></use><use href="#gentle-wave" x="48" y="5"></use><use href="#gentle-wave" x="48" y="7"></use></g></svg></section><div id="post-top-cover"><img class="nolazyload" id="post-top-bg" src=""></div></header><main id="blog-container"><div class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container" itemscope itemtype="http://example.com/2025/05/08/%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%92%8Ccargo/"><header><a href="/tags/Rust%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" tabindex="-1" itemprop="url">Rust基础知识</a><h1 id="CrawlerTitle" itemprop="name headline">模块系统和cargo</h1><span itemprop="author" itemscope itemtype="http://schema.org/Person">Jackey Zhou</span><time itemprop="dateCreated datePublished" datetime="2025-05-07T17:44:45.000Z" title="发表于 2025-05-08 01:44:45">2025-05-08</time><time itemprop="dateCreated datePublished" datetime="2025-05-07T18:00:27.846Z" title="更新于 2025-05-08 02:00:27">2025-05-08</time></header><p>模块系统 (Module System) 和 Cargo 是 Rust 开发中用于组织代码、管理项目和处理依赖的核心工具。理解它们对于编写任何规模的 Rust 程序都至关重要。</p>
<h3 id="模块系统-The-Module-System"><a href="#模块系统-The-Module-System" class="headerlink" title="模块系统 (The Module System)"></a>模块系统 (The Module System)</h3><p>Rust 的模块系统用于将代码组织成逻辑单元，控制代码的可见性（封装），并创建清晰的命名空间。</p>
<h4 id="1-核心概念"><a href="#1-核心概念" class="headerlink" title="1. 核心概念"></a>1. 核心概念</h4><ul>
<li><p><strong>包 (Package)</strong>:</p>
<ul>
<li>一个包包含一个或多个 <strong>Crate</strong> (稍后解释) 以及一个 <code>Cargo.toml</code> 清单文件，该文件描述了如何构建这些 Crate。</li>
<li>一个包最多只能包含**一个库 Crate (library crate)**。</li>
<li>一个包可以包含**任意数量的二进制 Crate (binary crates)**。</li>
<li>但至少必须包含一个 Crate (库或二进制)。</li>
</ul>
</li>
<li><p><strong>Crate (单元包)</strong>:</p>
<ul>
<li>Crate 是 Rust 编译器一次处理的最小编译单元。代码首先被组织成 Crate。</li>
<li><strong>库 Crate (Library Crate)</strong>: 不会自行生成可执行文件，而是提供可供其他程序使用的功能（例如，通过 <code>use</code> 导入）。其根文件通常是 <code>src/lib.rs</code>。</li>
<li><strong>二进制 Crate (Binary Crate)</strong>: 会生成一个可执行程序。其根文件通常是 <code>src/main.rs</code>。如果一个包有 <code>src/main.rs</code> 和 <code>src/lib.rs</code>，那么它有两个 Crate：一个库和一个二进制文件，它们的名字与包名相同。</li>
<li>你也可以在 <code>src/bin/</code> 目录下放置多个 <code>.rs</code> 文件，每个文件都会被编译成一个独立的二进制 Crate。</li>
</ul>
</li>
<li><p><strong>模块 (Module)</strong>:</p>
<ul>
<li>在 Crate 内部，你可以使用模块来进一步组织代码，控制作用域和路径的私有性。</li>
<li>模块可以嵌套。</li>
<li>模块帮助将相关的定义（如函数、结构体、枚举、trait、常量等）组合在一起，并形成一个层次结构。</li>
</ul>
</li>
</ul>
<h4 id="2-定义模块"><a href="#2-定义模块" class="headerlink" title="2. 定义模块"></a>2. 定义模块</h4><p>使用 <code>mod</code> 关键字来定义模块。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/lib.rs 或 src/main.rs</span></span><br><span class="line"><span class="keyword">mod</span> front_of_house &#123; <span class="comment">// 定义一个名为 front_of_house 的模块</span></span><br><span class="line">    <span class="comment">// 模块内容默认是私有的</span></span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">mod</span> hosting &#123; <span class="comment">// 定义一个嵌套的、公开的模块 hosting</span></span><br><span class="line">        <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">add_to_waitlist</span>() &#123; <span class="comment">// 公开的函数</span></span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;Added to waitlist!&quot;</span>);</span><br><span class="line">            <span class="title function_ invoke__">seat_at_table</span>(); <span class="comment">// 可以调用同一模块内的私有函数</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">seat_at_table</span>() &#123; <span class="comment">// 私有的函数，只能在 hosting 模块内部访问</span></span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;Seated at table.&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">mod</span> serving &#123;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">take_order</span>() &#123;&#125;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">serve_order</span>() &#123;&#125;</span><br><span class="line">        <span class="keyword">fn</span> <span class="title function_">take_payment</span>() &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用模块中的项</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">eat_at_restaurant</span>() &#123;</span><br><span class="line">    <span class="comment">// 绝对路径 (从 crate 根开始)</span></span><br><span class="line">    crate::front_of_house::hosting::<span class="title function_ invoke__">add_to_waitlist</span>();</span><br><span class="line"></span><br><span class="line">    <span class="comment">// 相对路径 (从当前模块开始，这里当前模块是 crate 根)</span></span><br><span class="line">    front_of_house::hosting::<span class="title function_ invoke__">add_to_waitlist</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123; <span class="comment">// 如果这是 src/main.rs</span></span><br><span class="line">    <span class="title function_ invoke__">eat_at_restaurant</span>();</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><strong>将模块移到其他文件</strong>:<br>当模块变大时，你可能希望将其内容移到单独的文件中，以保持 <code>src/lib.rs</code> 或 <code>src/main.rs</code> 的整洁。</p>
<ul>
<li><p><strong>方法1 (单个文件模块)</strong>: 如果模块 <code>front_of_house</code> 在 <code>src/front_of_house.rs</code> 文件中：</p>
  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 src/lib.rs 或 src/main.rs 中:</span></span><br><span class="line"><span class="keyword">mod</span> front_of_house; <span class="comment">// Rust 会查找 src/front_of_house.rs 文件</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">use</span> crate::front_of_house::hosting; <span class="comment">// 可以重新导出，方便外部使用</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">eat_at_restaurant_v2</span>() &#123;</span><br><span class="line">    hosting::<span class="title function_ invoke__">add_to_waitlist</span>(); <span class="comment">// 如果 hosting 被 use 了</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>  然后在 <code>src/front_of_house.rs</code> 文件中定义模块内容：</p>
  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// src/front_of_house.rs</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> hosting &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">add_to_waitlist</span>() &#123;</span><br><span class="line">        <span class="built_in">println!</span>(<span class="string">&quot;Added to waitlist from separate file!&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// ... 其他 front_of_house 的内容</span></span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>方法2 (目录模块 - 旧式但仍支持)</strong>: 如果模块 <code>garden</code> 及其子模块在 <code>src/garden/</code> 目录下，并且模块根是 <code>src/garden/mod.rs</code>：</p>
  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 在 src/lib.rs 或 src/main.rs 中:</span></span><br><span class="line"><span class="keyword">mod</span> garden; <span class="comment">// Rust 会查找 src/garden.rs 或 src/garden/mod.rs</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// src/garden/mod.rs 中:</span></span><br><span class="line"><span class="keyword">pub</span> <span class="keyword">mod</span> vegetables; <span class="comment">// Rust 会查找 src/garden/vegetables.rs 或 src/garden/vegetables/mod.rs</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// src/garden/vegetables.rs 中:</span></span><br><span class="line"><span class="comment">// pub struct Asparagus &#123;&#125;</span></span><br></pre></td></tr></table></figure>
<p>  现代 Rust 更倾向于使用 <code>src/module_name.rs</code> 的方式，即使模块有子模块（子模块可以在 <code>module_name.rs</code> 内部定义，或者子模块自身也可以是单独的文件）。</p>
</li>
</ul>
<h4 id="3-路径-Paths"><a href="#3-路径-Paths" class="headerlink" title="3. 路径 (Paths)"></a>3. 路径 (Paths)</h4><p>路径用于命名模块中的项（函数、结构体、模块等）。</p>
<ul>
<li><strong>绝对路径 (Absolute Path)</strong>: 从 Crate 的根开始，使用 Crate 名或者字面量 <code>crate</code>。  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crate::front_of_house::hosting::<span class="title function_ invoke__">add_to_waitlist</span>();</span><br></pre></td></tr></table></figure></li>
<li><strong>相对路径 (Relative Path)</strong>: 从当前模块开始，使用 <code>self</code>、<code>super</code> 或当前模块中的标识符。<ul>
<li><code>self</code> 指代当前模块本身。</li>
<li><code>super</code> 指代当前模块的父模块。  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mod</span> parent_module &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">mod</span> child_module &#123;</span><br><span class="line">        <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">child_func</span>() &#123;</span><br><span class="line">            <span class="built_in">println!</span>(<span class="string">&quot;In child_func&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">call_child</span>() &#123;</span><br><span class="line">        <span class="comment">// 相对路径</span></span><br><span class="line">        child_module::<span class="title function_ invoke__">child_func</span>();</span><br><span class="line">        <span class="comment">// 或者 self::child_module::child_func();</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">mod</span> another_module &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">call_sibling_child</span>() &#123;</span><br><span class="line">        <span class="comment">// 相对路径，通过 super 访问兄弟模块</span></span><br><span class="line">        super::parent_module::child_module::<span class="title function_ invoke__">child_func</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h4 id="4-use-关键字"><a href="#4-use-关键字" class="headerlink" title="4. use 关键字"></a>4. <code>use</code> 关键字</h4><p><code>use</code> 关键字可以将路径（或路径的一部分）引入当前的本地作用域，从而避免重复写出冗长的路径。</p>
<figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 不使用 use</span></span><br><span class="line"><span class="comment">// crate::front_of_house::hosting::add_to_waitlist();</span></span><br><span class="line"></span><br><span class="line"><span class="comment">// 使用 use</span></span><br><span class="line"><span class="keyword">use</span> crate::front_of_house::hosting;</span><br><span class="line"><span class="comment">// 或者更习惯的做法是引入到父模块，然后通过父模块访问：</span></span><br><span class="line"><span class="comment">// use crate::front_of_house::hosting::add_to_waitlist;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    hosting::<span class="title function_ invoke__">add_to_waitlist</span>(); <span class="comment">// 直接使用 hosting</span></span><br><span class="line">    <span class="comment">// add_to_waitlist(); // 如果上面是 use crate::front_of_house::hosting::add_to_waitlist;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><strong><code>use</code> 的习惯用法</strong>:</p>
<ul>
<li>对于函数，通常引入到其父模块，然后通过模块名调用函数，以表明函数不是在本地定义的（例如 <code>hosting::add_to_waitlist()</code>）。</li>
<li>对于结构体、枚举和其他项，通常直接引入完整路径（例如 <code>use std::collections::HashMap;</code> 然后直接使用 <code>HashMap</code>）。</li>
<li>如果存在名称冲突，可以使用 <code>as</code> 关键字为引入的类型指定新的本地名称：  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::fmt::<span class="type">Result</span> <span class="keyword">as</span> FmtResult;</span><br><span class="line"><span class="keyword">use</span> std::io::<span class="type">Result</span> <span class="keyword">as</span> IoResult;</span><br><span class="line"><span class="comment">// fn func1() -&gt; FmtResult &#123; ... &#125;</span></span><br><span class="line"><span class="comment">// fn func2() -&gt; IoResult&lt;T&gt; &#123; ... &#125;</span></span><br></pre></td></tr></table></figure></li>
<li><strong><code>pub use</code></strong>: 可以将一个项引入作用域，并使其在当前模块的公共 API 中也可用（重新导出）。  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">mod</span> my_utils &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">mod</span> deep_module &#123;</span><br><span class="line">        <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">useful_function</span>() &#123;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="comment">// 将 useful_function 重新导出到 my_utils 模块的公共 API</span></span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">use</span> self::deep_module::useful_function;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    my_utils::<span class="title function_ invoke__">useful_function</span>(); <span class="comment">// 可以直接通过 my_utils 访问</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
<li><strong>嵌套路径和 <code>self</code></strong>:  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">use</span> std::io::&#123;<span class="keyword">self</span>, Write&#125;; <span class="comment">// 引入 std::io 和 std::io::Write</span></span><br><span class="line"><span class="comment">// 等同于:</span></span><br><span class="line"><span class="comment">// use std::io;</span></span><br><span class="line"><span class="comment">// use std::io::Write;</span></span><br></pre></td></tr></table></figure></li>
<li><strong>Glob 运算符 (<code>*</code>)</strong>: <code>use std::collections::*;</code> 会将 <code>std::collections</code> 中的所有公共项引入当前作用域。通常不推荐在库代码中使用，因为它会使作用域中的名称来源变得不明确，但在测试或特定应用场景中可能有用。</li>
</ul>
<h4 id="5-可见性-pub"><a href="#5-可见性-pub" class="headerlink" title="5. 可见性 (pub)"></a>5. 可见性 (<code>pub</code>)</h4><p>默认情况下，模块中的所有项（函数、方法、结构体、枚举、模块、常量）都是**私有的 (private)**。这意味着它们只能在其定义的模块及其子模块中被访问。</p>
<p>使用 <code>pub</code> 关键字可以使项**公开 (public)**，从而允许外部代码访问它。</p>
<ul>
<li><strong>公开函数</strong>: <code>pub fn my_func() &#123;&#125;</code></li>
<li><strong>公开结构体</strong>:<ul>
<li>如果结构体是 <code>pub</code>，其字段默认仍然是私有的。你需要为希望公开的字段也标记 <code>pub</code>。  <figure class="highlight rust"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">pub</span> <span class="keyword">struct</span> <span class="title class_">Breakfast</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> toast: <span class="type">String</span>,      <span class="comment">// 这个字段是公开的</span></span><br><span class="line">    seasonal_fruit: <span class="type">String</span>, <span class="comment">// 这个字段是私有的</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">impl</span> <span class="title class_">Breakfast</span> &#123;</span><br><span class="line">    <span class="keyword">pub</span> <span class="keyword">fn</span> <span class="title function_">summer</span>(toast: &amp;<span class="type">str</span>) <span class="punctuation">-&gt;</span> Breakfast &#123; <span class="comment">// 公开的关联函数 (构造函数)</span></span><br><span class="line">        Breakfast &#123;</span><br><span class="line">            toast: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(toast),</span><br><span class="line">            seasonal_fruit: <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;peaches&quot;</span>),</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">fn</span> <span class="title function_">main</span>() &#123;</span><br><span class="line">    <span class="keyword">let</span> <span class="keyword">mut </span><span class="variable">meal</span> = Breakfast::<span class="title function_ invoke__">summer</span>(<span class="string">&quot;Rye&quot;</span>);</span><br><span class="line">    meal.toast = <span class="type">String</span>::<span class="title function_ invoke__">from</span>(<span class="string">&quot;Wheat&quot;</span>); <span class="comment">// 可以访问公开字段</span></span><br><span class="line">    <span class="comment">// meal.seasonal_fruit = String::from(&quot;blueberries&quot;); // 错误！seasonal_fruit 是私有的</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><strong>公开枚举</strong>: 如果枚举是 <code>pub</code>，它的所有变体也都是公开的。</li>
<li><strong>更细粒度的可见性</strong>:<ul>
<li><code>pub(crate)</code>: 项在当前 Crate 内的任何地方都可见，但在 Crate 外部是私有的。</li>
<li><code>pub(super)</code>: 项在其父模块中可见。</li>
<li><code>pub(in path::to::module)</code>: 项在指定的 <code>path::to::module</code> 模块及其子模块中可见。</li>
</ul>
</li>
</ul>
<hr>
<h3 id="Cargo"><a href="#Cargo" class="headerlink" title="Cargo"></a>Cargo</h3><p>Cargo 是 Rust 的官方构建系统和包管理器。它负责处理许多常见的开发任务：</p>
<h4 id="1-Cargo-的核心功能"><a href="#1-Cargo-的核心功能" class="headerlink" title="1. Cargo 的核心功能"></a>1. Cargo 的核心功能</h4><ul>
<li><strong>项目管理</strong>: 创建新项目、组织项目结构。</li>
<li><strong>构建代码</strong>: 将 Rust 代码编译成可执行文件或库。</li>
<li><strong>依赖管理</strong>: 从 <a target="_blank" rel="noopener" href="https://crates.io/">crates.io</a> (Rust 的官方包注册中心) 下载并编译项目依赖的外部库 (crates)。</li>
<li><strong>测试</strong>: 运行单元测试、集成测试和文档测试。</li>
<li><strong>运行项目</strong>: 构建并执行二进制项目。</li>
<li><strong>文档生成</strong>: 为项目及其依赖生成文档。</li>
<li><strong>发布包</strong>: 将库发布到 crates.io。</li>
</ul>
<h4 id="2-Cargo-toml-清单文件"><a href="#2-Cargo-toml-清单文件" class="headerlink" title="2. Cargo.toml (清单文件)"></a>2. <code>Cargo.toml</code> (清单文件)</h4><p>每个 Rust 包的根目录下都有一个 <code>Cargo.toml</code> 文件，这是 Cargo 的清单文件，使用 TOML (Tom’s Obvious, Minimal Language) 格式。它包含了项目的元数据和配置信息。</p>
<p>一个典型的 <code>Cargo.toml</code> 文件包含以下部分：</p>
<ul>
<li><p><strong><code>[package]</code></strong>:</p>
<ul>
<li><code>name</code>: 包（也是生成的库或二进制文件的默认名称）的名称。</li>
<li><code>version</code>: 包的版本号 (遵循语义化版本 SemVer)。</li>
<li><code>authors</code>: 作者列表。</li>
<li><code>edition</code>: 要使用的 Rust 版本（例如 <code>&quot;2018&quot;</code>, <code>&quot;2021&quot;</code>, <code>&quot;2024&quot;</code>）。</li>
<li><code>description</code>, <code>license</code>, <code>repository</code> 等可选元数据。</li>
</ul>
</li>
<li><p><strong><code>[dependencies]</code></strong>:</p>
<ul>
<li>列出项目运行时所需的依赖项。</li>
<li><code>rand = &quot;0.8.5&quot;</code> (从 crates.io 获取 rand crate 的 0.8.5 版本或兼容版本)</li>
<li>可以指定版本号、Git 仓库路径、本地路径等。</li>
<li><code>serde = &#123; version = &quot;1.0&quot;, features = [&quot;derive&quot;] &#125;</code> (指定特性)</li>
</ul>
</li>
<li><p><strong><code>[dev-dependencies]</code></strong>:</p>
<ul>
<li>列出仅在测试、示例或基准测试期间需要的依赖项。这些不会被编译到最终的发布构建中。</li>
</ul>
</li>
<li><p><strong><code>[lib]</code> 和 <code>[[bin]]</code></strong>:</p>
<ul>
<li>如果需要，可以更详细地配置库或二进制文件的目标。例如，指定库的名称或二进制文件的路径。</li>
</ul>
</li>
<li><p><strong><code>[profile.*]</code> (构建配置)</strong>:</p>
<ul>
<li>允许你为不同的构建配置文件（如 <code>dev</code> 用于开发，<code>release</code> 用于发布）定制编译器设置。</li>
<li><code>[profile.dev]</code> (默认，<code>cargo build</code>): 优化级别较低，编译速度快，包含调试信息。</li>
<li><code>[profile.release]</code> (使用 <code>cargo build --release</code>): 优化级别高，执行速度快，编译时间长，调试信息较少。  <figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[profile.release]</span></span><br><span class="line"><span class="attr">opt-level</span> = <span class="number">3</span>    <span class="comment"># 优化级别 (0-3, s, z)</span></span><br><span class="line"><span class="attr">debug</span> = <span class="literal">false</span>    <span class="comment"># 是否包含调试符号</span></span><br><span class="line"><span class="attr">lto</span> = <span class="literal">true</span>       <span class="comment"># 启用链接时优化 (Link Time Optimization)</span></span><br><span class="line"><span class="attr">codegen-units</span> = <span class="number">1</span> <span class="comment"># 减少并行编译单元数以获得更好的优化，但编译更慢</span></span><br></pre></td></tr></table></figure></li>
</ul>
</li>
<li><p><strong>Workspaces</strong>: (稍后介绍)</p>
</li>
</ul>
<h4 id="3-主要-Cargo-命令"><a href="#3-主要-Cargo-命令" class="headerlink" title="3. 主要 Cargo 命令"></a>3. 主要 Cargo 命令</h4><p>在你的项目目录下，你可以从终端运行以下常用的 Cargo 命令：</p>
<ul>
<li><code>cargo new &lt;project_name&gt;</code>: 创建一个新的二进制项目（带 <code>src/main.rs</code>）。</li>
<li><code>cargo new &lt;project_name&gt; --lib</code>: 创建一个新的库项目（带 <code>src/lib.rs</code>）。</li>
<li><code>cargo build</code>: 编译当前包（及其依赖项），默认是开发模式 (dev profile)。可执行文件或库会放在 <code>target/debug/</code> 目录下。</li>
<li><code>cargo build --release</code>: 使用发布模式 (release profile) 编译，进行更多优化。输出在 <code>target/release/</code> 目录下。</li>
<li><code>cargo run</code>: 编译并运行二进制包。如果是库包，此命令无效。</li>
<li><code>cargo check</code>: 快速检查代码以确保它可以编译，但不产生任何可执行文件。比 <code>cargo build</code> 快得多，适合在编码时频繁检查。</li>
<li><code>cargo test</code>: 运行项目中的所有测试（单元测试、集成测试和文档测试）。</li>
<li><code>cargo doc</code>: 为当前包及其所有公共依赖项构建文档。</li>
<li><code>cargo doc --open</code>: 构建文档并在你的 web 浏览器中打开。</li>
<li><code>cargo clean</code>: 清理构建目录 (<code>target/</code>)，删除所有编译产物。</li>
<li><code>cargo update</code>: 根据 <code>Cargo.toml</code> 中的版本要求更新 <code>Cargo.lock</code> 文件和依赖项。</li>
<li><code>cargo install &lt;crate_name&gt;</code>: 从 crates.io 下载并编译指定的 crate（通常是二进制工具），并将其安装到你的用户二进制目录（通常是 <code>~/.cargo/bin/</code>）。</li>
<li><code>cargo publish</code>: 将你的库包发布到 crates.io (需要先登录 <code>cargo login</code>)。</li>
<li><code>cargo add &lt;dependency_name&gt;</code>: (Rust 1.62+) 自动将依赖项添加到 <code>Cargo.toml</code> 的 <code>[dependencies]</code> 部分。例如 <code>cargo add serde</code>。可以指定版本和特性。</li>
<li><code>cargo remove &lt;dependency_name&gt;</code>: (Rust 1.66+) 自动从 <code>Cargo.toml</code> 中移除依赖项。</li>
</ul>
<h4 id="4-项目结构"><a href="#4-项目结构" class="headerlink" title="4. 项目结构"></a>4. 项目结构</h4><p>Cargo 期望项目遵循一定的目录结构：</p>
<ul>
<li><code>Cargo.toml</code>: 清单文件，在项目根目录。</li>
<li><code>Cargo.lock</code>: 自动生成，用于锁定依赖项的确切版本。应提交到版本控制。</li>
<li><code>src/</code>: 源代码目录。<ul>
<li><code>src/main.rs</code>: 二进制 Crate 的根文件和 <code>main</code> 函数的入口点。</li>
<li><code>src/lib.rs</code>: 库 Crate 的根文件。</li>
<li><code>src/bin/name.rs</code>: 如果有多个二进制文件，每个文件放在 <code>src/bin/</code> 目录下，Cargo 会将它们编译成单独的可执行文件。</li>
</ul>
</li>
<li><code>tests/</code>: 集成测试文件放在这里。每个 <code>.rs</code> 文件会被编译成一个单独的测试 Crate。</li>
<li><code>examples/</code>: 项目的使用示例代码。每个 <code>.rs</code> 文件是一个独立的示例。</li>
<li><code>benches/</code>: 基准测试代码。</li>
<li><code>target/</code>: Cargo 存放所有编译产物和中间文件的目录。通常会将其添加到 <code>.gitignore</code>。</li>
</ul>
<h4 id="5-依赖管理和-Cargo-lock"><a href="#5-依赖管理和-Cargo-lock" class="headerlink" title="5. 依赖管理和 Cargo.lock"></a>5. 依赖管理和 <code>Cargo.lock</code></h4><p>当你添加一个依赖项到 <code>Cargo.toml</code> 并首次构建时，Cargo 会从 crates.io (或其他源) 下载该依赖项及其所有传递依赖项。它会解析所有版本要求，并选择一个满足所有条件的版本组合。</p>
<p>然后，Cargo 会将所有选定的依赖项及其确切版本记录在 <code>Cargo.lock</code> 文件中。此后，除非你显式运行 <code>cargo update</code> 或修改 <code>Cargo.toml</code> 中的版本约束，否则 <code>cargo build</code> 会始终使用 <code>Cargo.lock</code> 中指定的版本。这确保了**可复现的构建 (reproducible builds)**，即你和你的团队成员在不同时间、不同机器上构建项目时，都会使用完全相同的依赖版本。</p>
<h4 id="6-工作空间-Workspaces"><a href="#6-工作空间-Workspaces" class="headerlink" title="6. 工作空间 (Workspaces)"></a>6. 工作空间 (Workspaces)</h4><p>工作空间允许你将多个相关的包组织在一个共同的顶层结构下。这对于大型项目或一组相互依赖的库非常有用。</p>
<ul>
<li>在项目根目录创建一个 <code>Cargo.toml</code> 文件，其中包含一个 <code>[workspace]</code> 部分，列出工作空间的成员包。  <figure class="highlight toml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">// 顶层 Cargo.toml</span><br><span class="line"><span class="section">[workspace]</span></span><br><span class="line"><span class="attr">members</span> = [</span><br><span class="line">    <span class="string">&quot;adder&quot;</span>,      // 一个名为 <span class="string">&quot;adder&quot;</span> 的包 (在 adder/ 目录下)</span><br><span class="line">    <span class="string">&quot;add_one&quot;</span>,    // 一个名为 <span class="string">&quot;add_one&quot;</span> 的包 (在 add_one/ 目录下)</span><br><span class="line">    // <span class="string">&quot;add_two&quot;</span>, // 假设 add_two 依赖 add_one</span><br><span class="line">]</span><br><span class="line"><span class="attr">resolver</span> = <span class="string">&quot;2&quot;</span> // 推荐使用较新的依赖解析器</span><br></pre></td></tr></table></figure></li>
<li>每个成员包都有其自己的 <code>Cargo.toml</code> 文件，但它们会共享一个顶层的 <code>Cargo.lock</code> 文件和一个 <code>target</code> 输出目录。</li>
<li>在工作空间根目录运行 <code>cargo build</code> 或 <code>cargo test</code> 会构建或测试所有成员包。你可以使用 <code>-p &lt;package_name&gt;</code> 来指定单个包。</li>
</ul>
<h4 id="7-构建脚本-build-rs"><a href="#7-构建脚本-build-rs" class="headerlink" title="7. 构建脚本 (build.rs)"></a>7. 构建脚本 (<code>build.rs</code>)</h4><p>如果你的包需要在编译之前执行一些自定义的构建步骤（例如，编译本地的 C&#x2F;C++ 代码、生成代码、或与操作系统进行交互），你可以在包的根目录下创建一个 <code>build.rs</code> 文件。Cargo 会在编译你的包之前先编译并运行这个构建脚本。</p>
<hr>
<p>模块系统和 Cargo 共同为 Rust 开发者提供了一个强大、一致且易于使用的环境来组织代码、管理依赖和构建项目。它们是 Rust 生态系统成功的关键因素之一。</p>
</article><div class="post-copyright"><div class="copyright-cc-box"><i class="anzhiyufont anzhiyu-icon-copyright"></i></div><div class="post-copyright__author_box"><a class="post-copyright__author_img" href="/" title="头像"><img class="post-copyright__author_img_back" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"><img class="post-copyright__author_img_front" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" title="头像" alt="头像"></a><div class="post-copyright__author_name">Jackey Zhou</div><div class="post-copyright__author_desc"></div></div><div class="post-copyright__post__info"><a class="post-copyright__original" title="该文章为原创文章，注意版权协议" href="http://example.com/2025/05/08/%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%92%8Ccargo/">原创</a><a class="post-copyright-title"><span onclick="rm.copyPageUrl('http://example.com/2025/05/08/%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%92%8Ccargo/')">模块系统和cargo</span></a></div><div class="post-tools" id="post-tools"><div class="post-tools-left"><div class="rewardLeftButton"><div class="post-reward" onclick="anzhiyu.addRewardMask()"><div class="reward-button button--animated" title="赞赏作者"><i class="anzhiyufont anzhiyu-icon-hand-heart-fill"></i>打赏作者</div><div class="reward-main"><div class="reward-all"><span class="reward-title">感谢你赐予我前进的力量</span><ul class="reward-group"><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-weichat.png" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" target="_blank"><img class="post-qr-code-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/qrcode-alipay.png" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul><a class="reward-main-btn" href="/about/#about-reward" target="_blank"><div class="reward-text">赞赏者名单</div><div class="reward-dec">因为你们的支持让我意识到写文章的价值🙏</div></a></div></div></div><div id="quit-box" onclick="anzhiyu.removeRewardMask()" style="display: none"></div></div><div class="shareRight"><div class="share-link mobile"><div class="share-qrcode"><div class="share-button" title="使用手机访问这篇文章"><i class="anzhiyufont anzhiyu-icon-qrcode"></i></div><div class="share-main"><div class="share-main-all"><div id="qrcode" title="http://example.com/2025/05/08/%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%92%8Ccargo/"></div><div class="reward-dec">使用手机访问这篇文章</div></div></div></div></div><div class="share-link weibo"><a class="share-button" target="_blank" href="https://service.weibo.com/share/share.php?title=模块系统和cargo&amp;url=http://example.com/2025/05/08/%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F%E5%92%8Ccargo/&amp;pic=" rel="external nofollow noreferrer noopener"><i class="anzhiyufont anzhiyu-icon-weibo"></i></a></div><script>function copyCurrentPageUrl() {
  var currentPageUrl = window.location.href;
  var input = document.createElement("input");
  input.setAttribute("value", currentPageUrl);
  document.body.appendChild(input);
  input.select();
  input.setSelectionRange(0, 99999);
  document.execCommand("copy");
  document.body.removeChild(input);
}</script><div class="share-link copyurl"><div class="share-button" id="post-share-url" title="复制链接" onclick="copyCurrentPageUrl()"><i class="anzhiyufont anzhiyu-icon-link"></i></div></div></div></div></div><div class="post-copyright__notice"><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="http://example.com" target="_blank">Welcome To LifeTech's Blog</a>！</span></div></div><div class="post-tools-right"><div class="tag_share"><div class="post-meta__box"><div class="post-meta__box__tag-list"><a class="post-meta__box__tags" href="/tags/Rust%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"><span class="tags-punctuation"> <i class="anzhiyufont anzhiyu-icon-tag"></i></span>Rust基础知识<span class="tagsPageCount">21</span></a></div></div></div><div class="post_share"><div class="social-share" data-image="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/css/share.min.css" media="print" onload="this.media='all'"/><script src="https://cdn.cbd.int/butterfly-extsrc@1.1.3/sharejs/dist/js/social-share.min.js" defer="defer"></script></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2025/05/08/%E5%B9%B6%E5%8F%91/"><img class="prev-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">并发</div></div></a></div><div class="next-post pull-right"><a href="/2025/05/08/%E6%B5%8B%E8%AF%95/"><img class="next-cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">测试</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="anzhiyufont anzhiyu-icon-thumbs-up fa-fw" style="font-size: 1.5rem; margin-right: 4px"></i><span>喜欢这篇文章的人也看了</span></div><div class="relatedPosts-list"><div><a href="/2025/05/08/Copy%E5%92%8CMove/" title="Copy和Move"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-08</div><div class="title">Copy和Move</div></div></a></div><div><a href="/2025/05/08/FFI/" title="FFI"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-08</div><div class="title">FFI</div></div></a></div><div><a href="/2025/05/08/Rust%E5%B8%B8%E7%94%A8%E6%A0%87%E5%87%86%E5%BA%93/" title="Rust常用标准库"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-08</div><div class="title">Rust常用标准库</div></div></a></div><div><a href="/2025/05/08/Rust%E5%B8%B8%E7%94%A8%E7%AC%AC%E4%B8%89%E6%96%B9%E5%BA%93/" title="Rust常用第三方库"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-08</div><div class="title">Rust常用第三方库</div></div></a></div><div><a href="/2025/05/08/Rust%E5%BC%82%E6%AD%A5%E7%BC%96%E7%A8%8B/" title="Rust异步编程"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-08</div><div class="title">Rust异步编程</div></div></a></div><div><a href="/2025/05/08/Rust%E7%BB%BC%E5%90%88%E6%A1%88%E4%BE%8B/" title="Rust综合案例"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/" alt="cover"><div class="content is-center"><div class="date"><i class="anzhiyufont anzhiyu-icon-calendar-days fa-fw"></i> 2025-05-08</div><div class="title">Rust综合案例</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-content"><div class="author-info-avatar"><img class="avatar-img" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://bu.dusays.com/2023/04/27/64496e511b09c.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__description">记录技术成长的个人博客</div></div></div><div class="card-widget anzhiyu-right-widget" id="card-wechat" onclick="null"><div id="flip-wrapper"><div id="flip-content"><div class="face" style="background: url(https://bu.dusays.com/2023/01/13/63c02edf44033.png) center center / 100% no-repeat"></div><div class="back face" style="background: url(https://bu.dusays.com/2023/05/13/645fa415e8694.png) center center / 100% no-repeat"></div></div></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-bars"></i><span>文章目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E7%B3%BB%E7%BB%9F-The-Module-System"><span class="toc-number">1.</span> <span class="toc-text">模块系统 (The Module System)</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-%E6%A0%B8%E5%BF%83%E6%A6%82%E5%BF%B5"><span class="toc-number">1.1.</span> <span class="toc-text">1. 核心概念</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-%E5%AE%9A%E4%B9%89%E6%A8%A1%E5%9D%97"><span class="toc-number">1.2.</span> <span class="toc-text">2. 定义模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E8%B7%AF%E5%BE%84-Paths"><span class="toc-number">1.3.</span> <span class="toc-text">3. 路径 (Paths)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-use-%E5%85%B3%E9%94%AE%E5%AD%97"><span class="toc-number">1.4.</span> <span class="toc-text">4. use 关键字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E5%8F%AF%E8%A7%81%E6%80%A7-pub"><span class="toc-number">1.5.</span> <span class="toc-text">5. 可见性 (pub)</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Cargo"><span class="toc-number">2.</span> <span class="toc-text">Cargo</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#1-Cargo-%E7%9A%84%E6%A0%B8%E5%BF%83%E5%8A%9F%E8%83%BD"><span class="toc-number">2.1.</span> <span class="toc-text">1. Cargo 的核心功能</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-Cargo-toml-%E6%B8%85%E5%8D%95%E6%96%87%E4%BB%B6"><span class="toc-number">2.2.</span> <span class="toc-text">2. Cargo.toml (清单文件)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-%E4%B8%BB%E8%A6%81-Cargo-%E5%91%BD%E4%BB%A4"><span class="toc-number">2.3.</span> <span class="toc-text">3. 主要 Cargo 命令</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#4-%E9%A1%B9%E7%9B%AE%E7%BB%93%E6%9E%84"><span class="toc-number">2.4.</span> <span class="toc-text">4. 项目结构</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#5-%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86%E5%92%8C-Cargo-lock"><span class="toc-number">2.5.</span> <span class="toc-text">5. 依赖管理和 Cargo.lock</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#6-%E5%B7%A5%E4%BD%9C%E7%A9%BA%E9%97%B4-Workspaces"><span class="toc-number">2.6.</span> <span class="toc-text">6. 工作空间 (Workspaces)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#7-%E6%9E%84%E5%BB%BA%E8%84%9A%E6%9C%AC-build-rs"><span class="toc-number">2.7.</span> <span class="toc-text">7. 构建脚本 (build.rs)</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="anzhiyufont anzhiyu-icon-history"></i><span>最近发布</span></div><div class="aside-list"><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/12/%E6%A8%A1%E5%9E%8B%E9%83%A8%E7%BD%B2/" title="模型部署">模型部署</a><time datetime="2025-05-11T18:17:36.000Z" title="发表于 2025-05-12 02:17:36">2025-05-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/12/%E6%95%B0%E6%8D%AE%E7%A7%91%E5%AD%A6%E4%B8%8E%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/" title="数据科学与机器学习">数据科学与机器学习</a><time datetime="2025-05-11T18:17:28.000Z" title="发表于 2025-05-12 02:17:28">2025-05-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/12/pytorch%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="pytorch基础知识">pytorch基础知识</a><time datetime="2025-05-11T18:17:15.000Z" title="发表于 2025-05-12 02:17:15">2025-05-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/12/python%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" title="python基础知识">python基础知识</a><time datetime="2025-05-11T18:16:59.000Z" title="发表于 2025-05-12 02:16:59">2025-05-12</time></div></div><div class="aside-list-item no-cover"><div class="content"><a class="title" href="/2025/05/12/ASP-NET-WEB-API/" title="ASP.NET WEB API">ASP.NET WEB API</a><time datetime="2025-05-11T18:16:40.000Z" title="发表于 2025-05-12 02:16:40">2025-05-12</time></div></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"></div><div id="footer-bar"><div class="footer-bar-links"><div class="footer-bar-left"><div id="footer-bar-tips"><div class="copyright">&copy;2020 - 2025 By <a class="footer-bar-link" href="/" title="Jackey Zhou" target="_blank">Jackey Zhou</a></div></div><div id="footer-type-tips"></div></div><div class="footer-bar-right"><a class="footer-bar-link" target="_blank" rel="noopener" href="https://github.com/anzhiyu-c/hexo-theme-anzhiyu" title="主题">主题</a></div></div></div></footer></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="sidebar-site-data site-data is-center"><a href="/archives/" title="archive"><div class="headline">文章</div><div class="length-num">50</div></a><a href="/tags/" title="tag"><div class="headline">标签</div><div class="length-num">14</div></a><a href="/categories/" title="category"><div class="headline">分类</div><div class="length-num">0</div></a></div><span class="sidebar-menu-item-title">功能</span><div class="sidebar-menu-item"><a class="darkmode_switchbutton menu-child" href="javascript:void(0);" title="显示模式"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span>显示模式</span></a></div><div class="back-menu-list-groups"><div class="back-menu-list-group"><div class="back-menu-list-title">网页</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://blog.anheyu.com/" title="博客"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="/img/favicon.ico" alt="博客"/><span class="back-menu-item-text">博客</span></a></div></div><div class="back-menu-list-group"><div class="back-menu-list-title">项目</div><div class="back-menu-list"><a class="back-menu-item" target="_blank" rel="noopener" href="https://image.anheyu.com/" title="安知鱼图床"><img class="back-menu-item-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" onerror="this.onerror=null,this.src=&quot;/img/404.jpg&quot;" data-lazy-src="https://image.anheyu.com/favicon.ico" alt="安知鱼图床"/><span class="back-menu-item-text">安知鱼图床</span></a></div></div></div><span class="sidebar-menu-item-title">标签</span><div class="card-tags"><div class="item-headline"></div><div class="card-tag-cloud"><a href="/tags/CSharp%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">CSharp学习<sup>3</sup></a><a href="/tags/IDE%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 0.88rem;">IDE常用快捷键<sup>2</sup></a><a href="/tags/Rust%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/" style="font-size: 0.88rem;">Rust基础知识<sup>21</sup></a><a href="/tags/csharp%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">csharp相关学习<sup>5</sup></a><a href="/tags/docker%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">docker学习<sup>1</sup></a><a href="/tags/hexo%E5%8D%9A%E5%AE%A2%E5%B8%B8%E8%A7%81%E5%91%BD%E4%BB%A4/" style="font-size: 0.88rem;">hexo博客常见命令<sup>1</sup></a><a href="/tags/python%E7%9B%B8%E5%85%B3%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">python相关学习<sup>4</sup></a><a href="/tags/xmake%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">xmake学习<sup>3</sup></a><a href="/tags/%E4%B8%AA%E4%BA%BA%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">个人学习<sup>1</sup></a><a href="/tags/%E6%95%B0%E6%8D%AE%E5%88%86%E6%9E%90/" style="font-size: 0.88rem;">数据分析<sup>1</sup></a><a href="/tags/%E6%97%A0%E7%BA%BF%E8%B0%83%E8%AF%95/" style="font-size: 0.88rem;">无线调试<sup>1</sup></a><a href="/tags/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" style="font-size: 0.88rem;">深度学习<sup>1</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%B8%B8%E7%94%A8%E5%91%BD%E4%BB%A4/" style="font-size: 0.88rem;">系统常用命令<sup>2</sup></a><a href="/tags/%E7%B3%BB%E7%BB%9F%E5%B8%B8%E7%94%A8%E5%BF%AB%E6%8D%B7%E9%94%AE/" style="font-size: 0.88rem;">系统常用快捷键<sup>2</sup></a></div></div><hr/></div></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="anzhiyufont anzhiyu-icon-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="anzhiyufont anzhiyu-icon-arrows-left-right"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="anzhiyufont anzhiyu-icon-gear"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="anzhiyufont anzhiyu-icon-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></button></div></div><div id="nav-music"><a id="nav-music-hoverTips" onclick="anzhiyu.musicToggle()" accesskey="m">播放音乐</a><div id="console-music-bg"></div><meting-js id="8152976493" server="netease" type="playlist" mutex="true" preload="none" theme="var(--anzhiyu-main)" data-lrctype="0" order="random" volume="0.7"></meting-js></div><div id="rightMenu"><div class="rightMenu-group rightMenu-small"><div class="rightMenu-item" id="menu-backward"><i class="anzhiyufont anzhiyu-icon-arrow-left"></i></div><div class="rightMenu-item" id="menu-forward"><i class="anzhiyufont anzhiyu-icon-arrow-right"></i></div><div class="rightMenu-item" id="menu-refresh"><i class="anzhiyufont anzhiyu-icon-arrow-rotate-right" style="font-size: 1rem;"></i></div><div class="rightMenu-item" id="menu-top"><i class="anzhiyufont anzhiyu-icon-arrow-up"></i></div></div><div class="rightMenu-group rightMenu-line rightMenuPlugin"><div class="rightMenu-item" id="menu-copytext"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制选中文本</span></div><div class="rightMenu-item" id="menu-pastetext"><i class="anzhiyufont anzhiyu-icon-paste"></i><span>粘贴文本</span></div><a class="rightMenu-item" id="menu-commenttext"><i class="anzhiyufont anzhiyu-icon-comment-medical"></i><span>引用到评论</span></a><div class="rightMenu-item" id="menu-newwindow"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开</span></div><div class="rightMenu-item" id="menu-copylink"><i class="anzhiyufont anzhiyu-icon-link"></i><span>复制链接地址</span></div><div class="rightMenu-item" id="menu-copyimg"><i class="anzhiyufont anzhiyu-icon-images"></i><span>复制此图片</span></div><div class="rightMenu-item" id="menu-downloadimg"><i class="anzhiyufont anzhiyu-icon-download"></i><span>下载此图片</span></div><div class="rightMenu-item" id="menu-newwindowimg"><i class="anzhiyufont anzhiyu-icon-window-restore"></i><span>新窗口打开图片</span></div><div class="rightMenu-item" id="menu-search"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>站内搜索</span></div><div class="rightMenu-item" id="menu-searchBaidu"><i class="anzhiyufont anzhiyu-icon-magnifying-glass"></i><span>百度搜索</span></div><div class="rightMenu-item" id="menu-music-toggle"><i class="anzhiyufont anzhiyu-icon-play"></i><span>播放音乐</span></div><div class="rightMenu-item" id="menu-music-back"><i class="anzhiyufont anzhiyu-icon-backward"></i><span>切换到上一首</span></div><div class="rightMenu-item" id="menu-music-forward"><i class="anzhiyufont anzhiyu-icon-forward"></i><span>切换到下一首</span></div><div class="rightMenu-item" id="menu-music-playlist" onclick="window.open(&quot;https://y.qq.com/n/ryqq/playlist/8802438608&quot;, &quot;_blank&quot;);" style="display: none;"><i class="anzhiyufont anzhiyu-icon-radio"></i><span>查看所有歌曲</span></div><div class="rightMenu-item" id="menu-music-copyMusicName"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制歌名</span></div></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item menu-link" id="menu-randomPost"><i class="anzhiyufont anzhiyu-icon-shuffle"></i><span>随便逛逛</span></a><a class="rightMenu-item menu-link" href="/categories/"><i class="anzhiyufont anzhiyu-icon-cube"></i><span>博客分类</span></a><a class="rightMenu-item menu-link" href="/tags/"><i class="anzhiyufont anzhiyu-icon-tags"></i><span>文章标签</span></a></div><div class="rightMenu-group rightMenu-line rightMenuOther"><a class="rightMenu-item" id="menu-copy" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-copy"></i><span>复制地址</span></a><a class="rightMenu-item" id="menu-commentBarrage" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-message"></i><span class="menu-commentBarrage-text">关闭热评</span></a><a class="rightMenu-item" id="menu-darkmode" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-circle-half-stroke"></i><span class="menu-darkmode-text">深色模式</span></a><a class="rightMenu-item" id="menu-translate" href="javascript:void(0);"><i class="anzhiyufont anzhiyu-icon-language"></i><span>轉為繁體</span></a></div></div><div id="rightmenu-mask"></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.cbd.int/@fancyapps/ui@5.0.28/dist/fancybox/fancybox.umd.js"></script><script src="https://cdn.cbd.int/instant.page@5.2.0/instantpage.js" type="module"></script><script src="https://cdn.cbd.int/vanilla-lazyload@17.8.5/dist/lazyload.iife.min.js"></script><script src="https://cdn.cbd.int/node-snackbar@0.1.16/dist/snackbar.min.js"></script><canvas id="universe"></canvas><script async src="https://npm.elemecdn.com/anzhiyu-theme-static@1.0.0/dark/dark.js"></script><script>// 消除控制台打印
var HoldLog = console.log;
console.log = function () {};
let now1 = new Date();
queueMicrotask(() => {
  const Log = function () {
    HoldLog.apply(console, arguments);
  }; //在恢复前输出日志
  const grt = new Date("04/01/2021 00:00:00"); //此处修改你的建站时间或者网站上线时间
  now1.setTime(now1.getTime() + 250);
  const days = (now1 - grt) / 1000 / 60 / 60 / 24;
  const dnum = Math.floor(days);
  const ascll = [
    `欢迎使用安知鱼!`,
    `生活明朗, 万物可爱`,
    `
        
       █████╗ ███╗   ██╗███████╗██╗  ██╗██╗██╗   ██╗██╗   ██╗
      ██╔══██╗████╗  ██║╚══███╔╝██║  ██║██║╚██╗ ██╔╝██║   ██║
      ███████║██╔██╗ ██║  ███╔╝ ███████║██║ ╚████╔╝ ██║   ██║
      ██╔══██║██║╚██╗██║ ███╔╝  ██╔══██║██║  ╚██╔╝  ██║   ██║
      ██║  ██║██║ ╚████║███████╗██║  ██║██║   ██║   ╚██████╔╝
      ╚═╝  ╚═╝╚═╝  ╚═══╝╚══════╝╚═╝  ╚═╝╚═╝   ╚═╝    ╚═════╝
        
        `,
    "已上线",
    dnum,
    "天",
    "©2020 By 安知鱼 V1.6.14",
  ];
  const ascll2 = [`NCC2-036`, `调用前置摄像头拍照成功，识别为【小笨蛋】.`, `Photo captured: `, `🤪`];

  setTimeout(
    Log.bind(
      console,
      `\n%c${ascll[0]} %c ${ascll[1]} %c ${ascll[2]} %c${ascll[3]}%c ${ascll[4]}%c ${ascll[5]}\n\n%c ${ascll[6]}\n`,
      "color:#425AEF",
      "",
      "color:#425AEF",
      "color:#425AEF",
      "",
      "color:#425AEF",
      ""
    )
  );
  setTimeout(
    Log.bind(
      console,
      `%c ${ascll2[0]} %c ${ascll2[1]} %c \n${ascll2[2]} %c\n${ascll2[3]}\n`,
      "color:white; background-color:#4fd953",
      "",
      "",
      'background:url("https://npm.elemecdn.com/anzhiyu-blog@1.1.6/img/post/common/tinggge.gif") no-repeat;font-size:450%'
    )
  );

  setTimeout(Log.bind(console, "%c WELCOME %c 你好，小笨蛋.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(
      console,
      "%c ⚡ Powered by 安知鱼 %c 你正在访问 Jackey Zhou 的博客.",
      "color:white; background-color:#f0ad4e",
      ""
    )
  );

  setTimeout(Log.bind(console, "%c W23-12 %c 你已打开控制台.", "color:white; background-color:#4f90d9", ""));

  setTimeout(
    console.warn.bind(console, "%c S013-782 %c 你现在正处于监控中.", "color:white; background-color:#d9534f", "")
  );
});</script><script async src="/anzhiyu/random.js"></script><div class="js-pjax"><input type="hidden" name="page-type" id="page-type" value="post"></div><script>var visitorMail = "";
</script><script async data-pjax src="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/waterfall/waterfall.js"></script><script src="https://lf3-cdn-tos.bytecdntp.com/cdn/expire-1-M/qrcodejs/1.0.0/qrcode.min.js"></script><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.1.9/icon/ali_iconfont_css.css"><link rel="stylesheet" href="https://cdn.cbd.int/anzhiyu-theme-static@1.0.0/aplayer/APlayer.min.css" media="print" onload="this.media='all'"><script src="https://cdn.cbd.int/anzhiyu-blog-static@1.0.1/js/APlayer.min.js"></script><script src="https://cdn.cbd.int/hexo-anzhiyu-music@1.0.1/assets/js/Meting2.min.js"></script><script src="https://cdn.cbd.int/pjax@0.2.8/pjax.min.js"></script><script>let pjaxSelectors = ["head > title","#config-diff","#body-wrap","#rightside-config-hide","#rightside-config-show",".js-pjax"]
var pjax = new Pjax({
  elements: 'a:not([target="_blank"])',
  selectors: pjaxSelectors,
  cacheBust: false,
  analytics: false,
  scrollRestoration: false
})

document.addEventListener('pjax:send', function () {
  // removeEventListener scroll 
  anzhiyu.removeGlobalFnEvent('pjax')
  anzhiyu.removeGlobalFnEvent('themeChange')

  document.getElementById('rightside').classList.remove('rightside-show')
  
  if (window.aplayers) {
    for (let i = 0; i < window.aplayers.length; i++) {
      if (!window.aplayers[i].options.fixed) {
        window.aplayers[i].destroy()
      }
    }
  }

  typeof typed === 'object' && typed.destroy()

  //reset readmode
  const $bodyClassList = document.body.classList
  $bodyClassList.contains('read-mode') && $bodyClassList.remove('read-mode')
})

document.addEventListener('pjax:complete', function () {
  window.refreshFn()

  document.querySelectorAll('script[data-pjax]').forEach(item => {
    const newScript = document.createElement('script')
    const content = item.text || item.textContent || item.innerHTML || ""
    Array.from(item.attributes).forEach(attr => newScript.setAttribute(attr.name, attr.value))
    newScript.appendChild(document.createTextNode(content))
    item.parentNode.replaceChild(newScript, item)
  })

  GLOBAL_CONFIG.islazyload && window.lazyLoadInstance.update()

  typeof panguInit === 'function' && panguInit()

  // google analytics
  typeof gtag === 'function' && gtag('config', '', {'page_path': window.location.pathname});

  // baidu analytics
  typeof _hmt === 'object' && _hmt.push(['_trackPageview',window.location.pathname]);

  typeof loadMeting === 'function' && document.getElementsByClassName('aplayer').length && loadMeting()

  // prismjs
  typeof Prism === 'object' && Prism.highlightAll()
})

document.addEventListener('pjax:error', e => {
  if (e.request.status === 404) {
    pjax.loadUrl('/404.html')
  }
})</script><script charset="UTF-8" src="https://cdn.cbd.int/anzhiyu-theme-static@1.1.5/accesskey/accesskey.js"></script></div><div id="popup-window"><div class="popup-window-title">通知</div><div class="popup-window-divider"></div><div class="popup-window-content"><div class="popup-tip">你好呀</div><div class="popup-link"><i class="anzhiyufont anzhiyu-icon-arrow-circle-right"></i></div></div></div></body></html>